<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.336">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Agam Safaruddin">

<title>MyLabJournal - Fundamental</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/icons/favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MyLabJournal</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-journal" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Journal</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-journal">    
        <li>
    <a class="dropdown-item" href="../../content/01_journal/01_fundamental.html" rel="" target="">
 <span class="dropdown-text">01 Fundamental</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/02_ml_regression.html" rel="" target="">
 <span class="dropdown-text">02 Machine Learning Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/03_ml_h2o_1.html" rel="" target="">
 <span class="dropdown-text">03 Machine LEarning H2O 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/04_ml_h2o_2_and_performance_measures.html" rel="" target="">
 <span class="dropdown-text">04 Machine Learning H2O 2 &amp; Performance Measures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/Test_Training.html" rel="" target="">
 <span class="dropdown-text">tEst pAge</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../content/02_notes/05_class_notes.html" rel="" target="">
 <span class="menu-text">Class notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../content/03_other/06_links.html" rel="" target="">
 <span class="menu-text">Links</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#requirements" id="toc-requirements" class="nav-link active" data-scroll-target="#requirements"><span class="header-section-number">1</span> Requirements</a>
  <ul class="collapse">
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">1.1</span> Libraries</a></li>
  <li><a href="#get-data" id="toc-get-data" class="nav-link" data-scroll-target="#get-data"><span class="header-section-number">1.2</span> Get Data</a></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing"><span class="header-section-number">1.3</span> preprocessing</a></li>
  </ul></li>
  <li><a href="#umap" id="toc-umap" class="nav-link" data-scroll-target="#umap"><span class="header-section-number">2</span> UMAP</a></li>
  <li><a href="#k-means-clustering-for-10-centers" id="toc-k-means-clustering-for-10-centers" class="nav-link" data-scroll-target="#k-means-clustering-for-10-centers"><span class="header-section-number">3</span> <strong>K means clustering for 10 centers</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Fundamental</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Agam Safaruddin </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="requirements" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Requirements</h1>
<section id="libraries" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="libraries"><span class="header-section-number">1.1</span> Libraries</h2>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-1_db20181d4c240ae12aad4f37adfe664a">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'tidyverse' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'ggplot2' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'tibble' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'tidyr' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'readr' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'purrr' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'dplyr' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'stringr' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'forcats' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'lubridate' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
#&gt; ✔ dplyr     1.1.2     ✔ readr     2.1.4
#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.0
#&gt; ✔ ggplot2   3.4.2     ✔ tibble    3.2.1
#&gt; ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
#&gt; ✔ purrr     1.0.1     
#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
#&gt; ✖ dplyr::filter() masks stats::filter()
#&gt; ✖ dplyr::lag()    masks stats::lag()
#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">library</span>(modelr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'modelr' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Paket 'readxl' wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; 
#&gt; Attache Paket: 'broom'
#&gt; 
#&gt; Das folgende Objekt ist maskiert 'package:modelr':
#&gt; 
#&gt;     bootstrap</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">library</span>(umap)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">library</span>(ggrepel) <span class="co"># Addon for ggplot, so that the labels do not overlap</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="fu">library</span>(tidyquant) <span class="co"># TO use tq_theme()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Lade nötiges Paket: PerformanceAnalytics
#&gt; Lade nötiges Paket: xts
#&gt; Lade nötiges Paket: zoo
#&gt; 
#&gt; Attache Paket: 'zoo'
#&gt; 
#&gt; Die folgenden Objekte sind maskiert von 'package:base':
#&gt; 
#&gt;     as.Date, as.Date.numeric
#&gt; 
#&gt; 
#&gt; Attache Paket: 'xts'
#&gt; 
#&gt; Die folgenden Objekte sind maskiert von 'package:dplyr':
#&gt; 
#&gt;     first, last
#&gt; 
#&gt; 
#&gt; Attache Paket: 'PerformanceAnalytics'
#&gt; 
#&gt; Das folgende Objekt ist maskiert 'package:graphics':
#&gt; 
#&gt;     legend
#&gt; 
#&gt; Lade nötiges Paket: quantmod
#&gt; Lade nötiges Paket: TTR
#&gt; Registered S3 method overwritten by 'quantmod':
#&gt;   method            from
#&gt;   as.zoo.data.frame zoo</code></pre>
</div>
</div>
</section>
<section id="get-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="get-data"><span class="header-section-number">1.2</span> Get Data</h2>
<ul>
<li>Important: company, sector</li>
<li>Important: symbol, date, adjusted</li>
<li>Adjusted means, price of stock after paying off dividends</li>
</ul>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-2_e6929ac7275f4e7b5d7b52d6672833bc">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>sp_500_daily_returns_tbl <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"datas/sp_500_daily_returns_tbl.rds"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>sp_500_index_tbl <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"datas/sp_500_index_tbl.rds"</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a>sp_500_prices_tbl <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"datas/sp_500_prices_tbl.rds"</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a>stock_date_matrix_table <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"datas/stock_date_matrix_tbl.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preprocessing" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="preprocessing"><span class="header-section-number">1.3</span> preprocessing</h2>
<p><strong>Join table of index_tbl and prices_tbl</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-3_9ad2cfa859cd6153f8423b385b0d17ac">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>sp_500_prices_index_joined_tbl <span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(sp_500_prices_tbl, sp_500_index_tbl, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"symbol"</span> <span class="ot">=</span> <span class="st">"symbol"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Filtering out non essentials and dates earlier than 2018</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-4_540bfa535139344f86b7542973a8a733">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>sp_500_prices_index_joined_essentials_tbl <span class="ot">=</span> sp_500_prices_index_joined_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>open, <span class="sc">-</span>high, <span class="sc">-</span>low, <span class="sc">-</span>close, <span class="sc">-</span>volume, <span class="sc">-</span>weight, <span class="sc">-</span>shares_held) <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2018-01-01"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Standardize / Normalize</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-5_f1048cef839ecbef8ca17df21ff85ac5">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>sp_500_prices_index_joined_essentials_normalized_tbl <span class="ot">=</span> sp_500_prices_index_joined_essentials_tbl <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>     <span class="fu">group_by</span>(symbol) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="co">#mutate(adjusted_normalized = adjusted / sum(adjusted))</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="fu">mutate</span>(<span class="at">adjusted_normalized =</span> <span class="fu">scale</span>(adjusted)) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="fu">mutate</span>(<span class="at">percentage_change_adjusted_normalized =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(adjusted_normalized))<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>    <span class="fu">mutate</span>(<span class="at">percentage_change_adjusted =</span> (adjusted_normalized <span class="sc">-</span> <span class="fu">lag</span>(adjusted_normalized)) <span class="sc">/</span> <span class="fu">lag</span>(adjusted_normalized)) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="fu">mutate</span>(<span class="at">percentage_change_adjusted_using_adjusted =</span> (adjusted <span class="sc">-</span> <span class="fu">lag</span>(adjusted)) <span class="sc">/</span> <span class="fu">lag</span>(adjusted)) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Cleaning previous table</strong> * This is the daily return table</p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-6_7c1ccd0a28e161d8ba82f7a7be03e542">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>sp_500_prices_index_joined_essentials_normalized_latest_tbl <span class="ot">=</span> sp_500_prices_index_joined_essentials_normalized_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>    <span class="fu">select</span>(<span class="sc">-</span>adjusted_normalized, <span class="sc">-</span>percentage_change_adjusted_normalized, <span class="sc">-</span>percentage_change_adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>    <span class="fu">rename</span>(<span class="at">pct_return =</span> percentage_change_adjusted_using_adjusted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Pick only symbol, date, pct_return</strong> * Naming readjustment: sp_500_prices_index_joined_essentials_normalized_latest_tbl &gt;&gt;&gt;&gt; sp_500_dailyreturns_tbl * Get rid of NA, change to 0</p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-7_e643730ce3230551f03a174ee07f91e9">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>sp_500_dailyreturns_tbl <span class="ot">=</span> sp_500_prices_index_joined_essentials_normalized_latest_tbl <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>    <span class="fu">select</span>(<span class="sc">-</span>adjusted, <span class="sc">-</span>company, <span class="sc">-</span>sector)</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a>sp_500_dailyreturns_tbl[<span class="fu">is.na</span>(sp_500_dailyreturns_tbl)] <span class="ot">=</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>User-Item (symbol - pct_return) format</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-8_65fce3c19c9a77a62c4513fcd84c5475">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>stock_date_matrix_tbl <span class="ot">=</span> sp_500_dailyreturns_tbl <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>    <span class="fu">select</span>(symbol, date, pct_return) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> date, <span class="at">values_from =</span> pct_return, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="fu">arrange</span>(symbol) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="st">'2018-01-02'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>K Means Clustering</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-9_2793b6fbb1e8a352e219b38326e2d984">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>kmeans_obj_challenge <span class="ot">&lt;-</span> stock_date_matrix_tbl <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>    <span class="fu">select</span>(<span class="sc">-</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="fu">kmeans</span>(<span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>**Checking results*</p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-10_3361d26addf64bda57c6479b92e1fbb4">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(kmeans_obj_challenge) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 4
#&gt; Columns: 285
#&gt; $ `2018-01-03` &lt;dbl&gt; 0.005217181, 0.014549433, -0.003333954, 0.014025528
#&gt; $ `2018-01-04` &lt;dbl&gt; 0.004542594, 0.011343742, -0.006912672, 0.004891946
#&gt; $ `2018-01-05` &lt;dbl&gt; 0.0065882996, 0.0006474687, 0.0012340690, 0.0092884855
#&gt; $ `2018-01-08` &lt;dbl&gt; 0.001682355, 0.005827603, 0.005406745, 0.008080790
#&gt; $ `2018-01-09` &lt;dbl&gt; 0.0035926461, -0.0061031977, -0.0089961936, -0.0003389287
#&gt; $ `2018-01-10` &lt;dbl&gt; -0.0003417889, 0.0012472656, -0.0120427739, -0.0020594364
#&gt; $ `2018-01-11` &lt;dbl&gt; 0.011272867, 0.023712257, -0.004826786, 0.009308274
#&gt; $ `2018-01-12` &lt;dbl&gt; 0.008286783, 0.010296386, -0.005236483, 0.009571419
#&gt; $ `2018-01-16` &lt;dbl&gt; -0.007601889, -0.014205000, 0.001309974, -0.008449825
#&gt; $ `2018-01-17` &lt;dbl&gt; 0.007489971, 0.008879761, 0.007494267, 0.015404285
#&gt; $ `2018-01-18` &lt;dbl&gt; -0.001424046, -0.009114860, -0.006708276, 0.001998036
#&gt; $ `2018-01-19` &lt;dbl&gt; 0.007923882, 0.001324402, 0.004566404, 0.006715878
#&gt; $ `2018-01-22` &lt;dbl&gt; 0.004611634, 0.024772066, 0.006985181, 0.009735809
#&gt; $ `2018-01-23` &lt;dbl&gt; 0.0009158796, -0.0005949105, 0.0080806520, 0.0093980814
#&gt; $ `2018-01-24` &lt;dbl&gt; 0.002736219, -0.006334400, -0.003852982, -0.007636793
#&gt; $ `2018-01-25` &lt;dbl&gt; 6.261335e-05, -1.029610e-02, 5.819039e-03, -4.868228e-03
#&gt; $ `2018-01-26` &lt;dbl&gt; 0.0112167041, 0.0060671176, 0.0008990918, 0.0166806037
#&gt; $ `2018-01-29` &lt;dbl&gt; -0.006083350, -0.015217440, -0.011666174, -0.005021227
#&gt; $ `2018-01-30` &lt;dbl&gt; -0.011773883, -0.021314151, -0.003053078, -0.009723839
#&gt; $ `2018-01-31` &lt;dbl&gt; -0.003893409, 0.001732506, 0.010838715, 0.005783896
#&gt; $ `2018-02-01` &lt;dbl&gt; -0.0002198492, 0.0088676780, -0.0147069869, 0.0021775377
#&gt; $ `2018-02-02` &lt;dbl&gt; -0.01945987, -0.03741749, -0.01321817, -0.02295550
#&gt; $ `2018-02-05` &lt;dbl&gt; -0.03929605, -0.03711698, -0.02624758, -0.03846852
#&gt; $ `2018-02-06` &lt;dbl&gt; 0.014327389, 0.013342351, -0.000769148, 0.025070219
#&gt; $ `2018-02-07` &lt;dbl&gt; 0.0006988956, -0.0190853955, -0.0052130982, -0.0074124405
#&gt; $ `2018-02-08` &lt;dbl&gt; -0.03645141, -0.03955006, -0.02013127, -0.04115078
#&gt; $ `2018-02-09` &lt;dbl&gt; 0.01201566, -0.00291801, 0.01909034, 0.02162704
#&gt; $ `2018-02-12` &lt;dbl&gt; 0.012262163, 0.022509484, 0.005043885, 0.018492458
#&gt; $ `2018-02-13` &lt;dbl&gt; 0.002250963, -0.006038450, 0.003804489, 0.008702354
#&gt; $ `2018-02-14` &lt;dbl&gt; 0.017405799, 0.028709277, -0.004153567, 0.024552532
#&gt; $ `2018-02-15` &lt;dbl&gt; 0.009018172, -0.005064078, 0.016542153, 0.016512878
#&gt; $ `2018-02-16` &lt;dbl&gt; 0.0009879948, -0.0050865513, 0.0050883535, -0.0064207255
#&gt; $ `2018-02-20` &lt;dbl&gt; -0.0076134581, 0.0004252287, -0.0117393604, 0.0060618583
#&gt; $ `2018-02-21` &lt;dbl&gt; -0.002297952, -0.016731442, -0.016373701, -0.004441781
#&gt; $ `2018-02-22` &lt;dbl&gt; -0.001782200, 0.009769590, 0.007334973, -0.002997867
#&gt; $ `2018-02-23` &lt;dbl&gt; 0.01341795, 0.02115968, 0.01800925, 0.02195730
#&gt; $ `2018-02-26` &lt;dbl&gt; 8.558352e-03, 9.924278e-05, 2.523189e-03, 1.220083e-02
#&gt; $ `2018-02-27` &lt;dbl&gt; -0.013163471, -0.014163508, -0.016890593, -0.009308126
#&gt; $ `2018-02-28` &lt;dbl&gt; -0.012030574, -0.023712904, -0.004953530, -0.005461278
#&gt; $ `2018-03-01` &lt;dbl&gt; -0.013488875, 0.001114025, -0.000381493, -0.014143419
#&gt; $ `2018-03-02` &lt;dbl&gt; 0.005346057, 0.007737213, 0.001200669, 0.021342169
#&gt; $ `2018-03-05` &lt;dbl&gt; 0.01038346, 0.01108851, 0.01370457, 0.01379969
#&gt; $ `2018-03-06` &lt;dbl&gt; 0.0061748492, 0.0003806278, -0.0019166661, 0.0087369561
#&gt; $ `2018-03-07` &lt;dbl&gt; -0.001323156, -0.007205835, -0.002145171, 0.007337585
#&gt; $ `2018-03-08` &lt;dbl&gt; 0.001313594, 0.001223280, 0.007270226, 0.008156522
#&gt; $ `2018-03-09` &lt;dbl&gt; 0.017891556, 0.021309965, 0.004711574, 0.017801101
#&gt; $ `2018-03-12` &lt;dbl&gt; -0.0035181932, -0.0005388962, 0.0031507710, 0.0027135945
#&gt; $ `2018-03-13` &lt;dbl&gt; -0.003675462, -0.008199908, 0.001106390, -0.012076285
#&gt; $ `2018-03-14` &lt;dbl&gt; -0.0084294900, -0.0017622280, 0.0009870808, 0.0002114269
#&gt; $ `2018-03-15` &lt;dbl&gt; -0.001428887, -0.012297035, -0.002700715, -0.002123033
#&gt; $ `2018-03-16` &lt;dbl&gt; 0.0043333233, 0.0129985324, 0.0054389622, 0.0008341013
#&gt; $ `2018-03-19` &lt;dbl&gt; -0.010398300, -0.017670238, -0.007648673, -0.017248805
#&gt; $ `2018-03-20` &lt;dbl&gt; 0.000171361, 0.013784848, -0.003879733, 0.004318024
#&gt; $ `2018-03-21` &lt;dbl&gt; 0.0004388795, 0.0337207010, -0.0090580220, -0.0017923612
#&gt; $ `2018-03-22` &lt;dbl&gt; -0.027250330, -0.021459951, -0.003464591, -0.026251915
#&gt; $ `2018-03-23` &lt;dbl&gt; -0.019522841, -0.007163383, -0.013739589, -0.025754376
#&gt; $ `2018-03-26` &lt;dbl&gt; 0.02449549, 0.01896047, 0.01267397, 0.03407693
#&gt; $ `2018-03-27` &lt;dbl&gt; -0.013135617, -0.013465892, 0.007715361, -0.032635868
#&gt; $ `2018-03-28` &lt;dbl&gt; -0.0004245702, -0.0233216532, 0.0112983042, -0.0121534871
#&gt; $ `2018-03-29` &lt;dbl&gt; 0.013363731, 0.023735936, 0.004369175, 0.018762622
#&gt; $ `2018-04-02` &lt;dbl&gt; -0.02238548, -0.02377674, -0.01422130, -0.02940422
#&gt; $ `2018-04-03` &lt;dbl&gt; 0.012621133, 0.019605101, 0.007764893, 0.012355715
#&gt; $ `2018-04-04` &lt;dbl&gt; 0.012434839, 0.001227871, 0.010279533, 0.015777681
#&gt; $ `2018-04-05` &lt;dbl&gt; 0.007176211, 0.019447924, 0.002828578, 0.001453854
#&gt; $ `2018-04-06` &lt;dbl&gt; -0.023302068, -0.022406930, -0.007734639, -0.029807187
#&gt; $ `2018-04-09` &lt;dbl&gt; 0.0013397648, 0.0025547209, -0.0001039607, 0.0072958976
#&gt; $ `2018-04-10` &lt;dbl&gt; 0.015147638, 0.038827519, -0.001881378, 0.025353351
#&gt; $ `2018-04-11` &lt;dbl&gt; -0.0067400406, 0.0130939406, -0.0007348127, -0.0056141513
#&gt; $ `2018-04-12` &lt;dbl&gt; 0.008179894, 0.001740217, -0.010752601, 0.015962569
#&gt; $ `2018-04-13` &lt;dbl&gt; -0.005095188, 0.013155802, 0.005563910, -0.007832302
#&gt; $ `2018-04-16` &lt;dbl&gt; 0.011016656, 0.008616509, 0.008682951, 0.004860507
#&gt; $ `2018-04-17` &lt;dbl&gt; 0.006195900, 0.006042663, 0.007863409, 0.022161608
#&gt; $ `2018-04-18` &lt;dbl&gt; 0.0032189057, 0.0206900471, -0.0046798570, 0.0002988631
#&gt; $ `2018-04-19` &lt;dbl&gt; -0.003267487, 0.001786194, -0.013599108, -0.018124119
#&gt; $ `2018-04-20` &lt;dbl&gt; -0.005666901, -0.003468391, -0.012187591, -0.010631547
#&gt; $ `2018-04-23` &lt;dbl&gt; 0.002505648, 0.006591688, 0.001157400, -0.003682519
#&gt; $ `2018-04-24` &lt;dbl&gt; -0.01123779, -0.01599992, 0.00221505, -0.01618772
#&gt; $ `2018-04-25` &lt;dbl&gt; 0.0039772566, 0.0059983491, 0.0002285739, -0.0050286856
#&gt; $ `2018-04-26` &lt;dbl&gt; 0.003569482, 0.011457675, 0.010261824, 0.020824552
#&gt; $ `2018-04-27` &lt;dbl&gt; 0.003206567, -0.009243902, 0.011958287, -0.004572574
#&gt; $ `2018-04-30` &lt;dbl&gt; -1.188822e-02, 5.650547e-05, -5.828280e-03, -4.215671e-03
#&gt; $ `2018-05-01` &lt;dbl&gt; -0.0005850741, -0.0050385450, 0.0007776130, 0.0119120995
#&gt; $ `2018-05-02` &lt;dbl&gt; -0.010327390, 0.008551843, -0.009884618, -0.003166279
#&gt; $ `2018-05-03` &lt;dbl&gt; -0.005367388, -0.003354957, 0.001865179, 0.004031093
#&gt; $ `2018-05-04` &lt;dbl&gt; 0.0118618730, 0.0002403534, 0.0115802919, 0.0152252115
#&gt; $ `2018-05-07` &lt;dbl&gt; 0.0006844511, -0.0006381188, -0.0003423209, 0.0107081957
#&gt; $ `2018-05-08` &lt;dbl&gt; 0.0007354292, 0.0103725962, -0.0117845845, 0.0042713777
#&gt; $ `2018-05-09` &lt;dbl&gt; 0.006015187, 0.019005395, 0.002356665, 0.018287598
#&gt; $ `2018-05-10` &lt;dbl&gt; 0.008198444, 0.003092002, 0.008776411, 0.012255246
#&gt; $ `2018-05-11` &lt;dbl&gt; 0.003294055, -0.001898366, -0.001332108, -0.004284660
#&gt; $ `2018-05-14` &lt;dbl&gt; 0.0005690565, 0.0057983409, -0.0055922557, 0.0016992322
#&gt; $ `2018-05-15` &lt;dbl&gt; -0.003929441, 0.004290063, -0.011670012, -0.004501408
#&gt; $ `2018-05-16` &lt;dbl&gt; 0.006577711, 0.008291791, -0.002364305, 0.008611112
#&gt; $ `2018-05-17` &lt;dbl&gt; 0.001955032, 0.020700579, -0.004893340, -0.004584975
#&gt; $ `2018-05-18` &lt;dbl&gt; -0.0005493316, -0.0059074763, -0.0039987220, -0.0022359815
#&gt; $ `2018-05-21` &lt;dbl&gt; 0.005961593, 0.008283126, 0.005779365, 0.005922644
#&gt; $ `2018-05-22` &lt;dbl&gt; -0.004840369, -0.013478278, 0.002482762, -0.003192814
#&gt; $ `2018-05-23` &lt;dbl&gt; 0.0006489749, -0.0044105608, 0.0085556910, 0.0057628973
#&gt; $ `2018-05-24` &lt;dbl&gt; 8.611148e-05, -1.261852e-02, 1.298424e-03, 1.489904e-03
#&gt; $ `2018-05-25` &lt;dbl&gt; -0.0012343964, -0.0266239832, 0.0047986326, 0.0006639455
#&gt; $ `2018-05-29` &lt;dbl&gt; -0.015959552, -0.001696881, 0.001238291, -0.006059243
#&gt; $ `2018-05-30` &lt;dbl&gt; 0.012555582, 0.028669361, 0.011695739, 0.009546631
#&gt; $ `2018-05-31` &lt;dbl&gt; -0.010942939, -0.012173706, -0.007053274, -0.001903148
#&gt; $ `2018-06-01` &lt;dbl&gt; 0.010095531, 0.002155198, -0.003547776, 0.022277656
#&gt; $ `2018-06-04` &lt;dbl&gt; 0.005981400, -0.012253263, 0.003162351, 0.003563116
#&gt; $ `2018-06-05` &lt;dbl&gt; 0.003198089, -0.002154042, -0.005049502, 0.007483896
#&gt; $ `2018-06-06` &lt;dbl&gt; 0.011968862, 0.003809198, -0.005781605, 0.008494834
#&gt; $ `2018-06-07` &lt;dbl&gt; 0.001149033, 0.016374668, 0.002795166, -0.013241385
#&gt; $ `2018-06-08` &lt;dbl&gt; 0.005784347, -0.004469895, 0.005472490, 0.004352640
#&gt; $ `2018-06-11` &lt;dbl&gt; 0.001753974, 0.005602012, 0.001419442, 0.002487955
#&gt; $ `2018-06-12` &lt;dbl&gt; 0.001399618, -0.005129724, 0.008011873, 0.008414511
#&gt; $ `2018-06-13` &lt;dbl&gt; -0.0055633906, -0.0031941768, -0.0102443629, 0.0006958373
#&gt; $ `2018-06-14` &lt;dbl&gt; 0.0009142176, -0.0051560680, 0.0089727967, 0.0095731668
#&gt; $ `2018-06-15` &lt;dbl&gt; 0.001952892, -0.022707272, 0.005189750, -0.001900661
#&gt; $ `2018-06-18` &lt;dbl&gt; -0.0026534461, 0.0173805699, -0.0037548361, 0.0009221515
#&gt; $ `2018-06-19` &lt;dbl&gt; -0.0061898455, 0.0006035218, 0.0055750955, -0.0088464161
#&gt; $ `2018-06-20` &lt;dbl&gt; 0.001076239, 0.010461839, 0.004292090, 0.006518084
#&gt; $ `2018-06-21` &lt;dbl&gt; -0.005383937, -0.022917019, 0.003094840, -0.010378518
#&gt; $ `2018-06-22` &lt;dbl&gt; 0.001021374, 0.024278987, 0.008221106, -0.007791614
#&gt; $ `2018-06-25` &lt;dbl&gt; -0.011979354, -0.026779988, 0.009402708, -0.025003868
#&gt; $ `2018-06-26` &lt;dbl&gt; -0.001118698, 0.017510326, 0.000226482, 0.003632608
#&gt; $ `2018-06-27` &lt;dbl&gt; -0.010185976, 0.015372888, -0.001854346, -0.020827173
#&gt; $ `2018-06-28` &lt;dbl&gt; 0.002804796, -0.003154605, 0.007254731, 0.010604506
#&gt; $ `2018-06-29` &lt;dbl&gt; -6.855821e-05, 6.801777e-03, 6.340609e-04, 3.736572e-03
#&gt; $ `2018-07-02` &lt;dbl&gt; 0.001471821, -0.016776871, -0.002681042, 0.007468319
#&gt; $ `2018-07-03` &lt;dbl&gt; -0.001898671, 0.009084328, 0.004025346, -0.011619902
#&gt; $ `2018-07-05` &lt;dbl&gt; 0.006614258, -0.001488715, 0.012383700, 0.013982441
#&gt; $ `2018-07-06` &lt;dbl&gt; 0.006908309, 0.013008260, 0.005028909, 0.012671282
#&gt; $ `2018-07-09` &lt;dbl&gt; 0.01402647, 0.01913839, -0.01604752, 0.00729805
#&gt; $ `2018-07-10` &lt;dbl&gt; 0.001312620, 0.003473632, 0.006173772, 0.003275802
#&gt; $ `2018-07-11` &lt;dbl&gt; -0.009738650, -0.024131440, 0.002633196, -0.008306789
#&gt; $ `2018-07-12` &lt;dbl&gt; 4.563560e-03, 7.366942e-05, 7.831687e-04, 1.727150e-02
#&gt; $ `2018-07-13` &lt;dbl&gt; 0.0012950176, 0.0050874219, 0.0004614193, -0.0023338092
#&gt; $ `2018-07-16` &lt;dbl&gt; -0.001679823, -0.015230587, -0.004724125, -0.002482895
#&gt; $ `2018-07-17` &lt;dbl&gt; 0.004588254, -0.001992870, -0.001728087, 0.008792052
#&gt; $ `2018-07-18` &lt;dbl&gt; 0.005521811, 0.001663189, -0.007769495, 0.002761209
#&gt; $ `2018-07-19` &lt;dbl&gt; -0.001518489, -0.001796304, 0.008153929, -0.004980070
#&gt; $ `2018-07-20` &lt;dbl&gt; -0.002652620, -0.003616946, -0.005246509, -0.004154766
#&gt; $ `2018-07-23` &lt;dbl&gt; 0.001778067, -0.003431901, -0.004892180, 0.002027684
#&gt; $ `2018-07-24` &lt;dbl&gt; -0.0004441636, 0.0104494824, -0.0005005501, -0.0080874714
#&gt; $ `2018-07-25` &lt;dbl&gt; 0.007192060, 0.008122618, 0.007607577, 0.016187298
#&gt; $ `2018-07-26` &lt;dbl&gt; 0.0029787150, 0.0131985204, 0.0079688330, -0.0006751857
#&gt; $ `2018-07-27` &lt;dbl&gt; -0.003446809, 0.001280992, -0.005027542, -0.020919476
#&gt; $ `2018-07-30` &lt;dbl&gt; -0.003156086, 0.012986403, -0.002331982, -0.021618702
#&gt; $ `2018-07-31` &lt;dbl&gt; 0.008038429, -0.002268616, 0.012574433, 0.002895817
#&gt; $ `2018-08-01` &lt;dbl&gt; -0.007249964, -0.015730558, -0.002755748, -0.002711583
#&gt; $ `2018-08-02` &lt;dbl&gt; 0.002993146, -0.002134323, 0.004132915, 0.014229673
#&gt; $ `2018-08-03` &lt;dbl&gt; 0.0051696868, -0.0073460616, 0.0134441240, -0.0002601396
#&gt; $ `2018-08-06` &lt;dbl&gt; 0.0014640732, 0.0052397976, 0.0002851608, 0.0082356891
#&gt; $ `2018-08-07` &lt;dbl&gt; 0.003157818, 0.003959465, -0.003699128, 0.003361766
#&gt; $ `2018-08-08` &lt;dbl&gt; -0.0006984346, -0.0085479395, -0.0047101273, 0.0003471306
#&gt; $ `2018-08-09` &lt;dbl&gt; -0.0007957794, -0.0108872145, 0.0015381073, -0.0008920641
#&gt; $ `2018-08-10` &lt;dbl&gt; -0.008728654, 0.007638768, -0.005940741, -0.009182561
#&gt; $ `2018-08-13` &lt;dbl&gt; -0.0054871905, -0.0144547914, 0.0008234634, -0.0022671805
#&gt; $ `2018-08-14` &lt;dbl&gt; 0.010200628, 0.004542780, 0.004398117, 0.006780214
#&gt; $ `2018-08-15` &lt;dbl&gt; -0.006691091, -0.042438317, 0.008029299, -0.015767129
#&gt; $ `2018-08-16` &lt;dbl&gt; 0.008967913, 0.006339482, 0.009135530, 0.004438533
#&gt; $ `2018-08-17` &lt;dbl&gt; 0.006126832, 0.003224037, 0.007732354, -0.001760454
#&gt; $ `2018-08-20` &lt;dbl&gt; 5.942634e-03, 8.421130e-03, 2.692069e-07, 4.049175e-03
#&gt; $ `2018-08-21` &lt;dbl&gt; 0.005122876, 0.008349307, -0.009589298, 0.008199431
#&gt; $ `2018-08-22` &lt;dbl&gt; -0.003894045, 0.013378383, -0.006575943, 0.006730186
#&gt; $ `2018-08-23` &lt;dbl&gt; -0.003921203, -0.005292100, -0.001255369, 0.001981029
#&gt; $ `2018-08-24` &lt;dbl&gt; 0.003449513, 0.008073458, 0.004500810, 0.015124691
#&gt; $ `2018-08-27` &lt;dbl&gt; 0.007595955, 0.009180901, -0.002951911, 0.009845194
#&gt; $ `2018-08-28` &lt;dbl&gt; 4.536910e-06, -5.525657e-03, 1.332308e-03, 3.794339e-03
#&gt; $ `2018-08-29` &lt;dbl&gt; 0.003219045, 0.007257279, 0.002524474, 0.007306630
#&gt; $ `2018-08-30` &lt;dbl&gt; -0.007957643, -0.002890487, -0.002927028, -0.006688627
#&gt; $ `2018-08-31` &lt;dbl&gt; 0.0014553869, -0.0073978491, 0.0011652746, 0.0006588377
#&gt; $ `2018-09-04` &lt;dbl&gt; -0.0012439741, -0.0073232978, -0.0024738521, -0.0009675634
#&gt; $ `2018-09-05` &lt;dbl&gt; 0.002183078, -0.004506993, 0.010518901, -0.018543501
#&gt; $ `2018-09-06` &lt;dbl&gt; -0.000759536, -0.019382860, 0.005232278, -0.011209654
#&gt; $ `2018-09-07` &lt;dbl&gt; -0.001954284, -0.004880020, -0.009005451, -0.004386366
#&gt; $ `2018-09-10` &lt;dbl&gt; 0.0029803154, 0.0006737391, 0.0056867858, 0.0087879660
#&gt; $ `2018-09-11` &lt;dbl&gt; 0.0005049789, 0.0122762856, -0.0019538731, 0.0018295441
#&gt; $ `2018-09-12` &lt;dbl&gt; 0.001161493, 0.009381701, 0.003579706, -0.002137449
#&gt; $ `2018-09-13` &lt;dbl&gt; 4.018751e-03, -2.306182e-06, 4.775531e-03, 6.462456e-03
#&gt; $ `2018-09-14` &lt;dbl&gt; 0.003053672, 0.004538664, -0.005895538, 0.001758224
#&gt; $ `2018-09-17` &lt;dbl&gt; -0.0031778985, 0.0006103131, 0.0034210890, -0.0163136879
#&gt; $ `2018-09-18` &lt;dbl&gt; 0.005551467, 0.011631923, -0.005822705, 0.010072334
#&gt; $ `2018-09-19` &lt;dbl&gt; 0.004069505, 0.002892712, -0.012892316, -0.002499493
#&gt; $ `2018-09-20` &lt;dbl&gt; 0.006322862, -0.004188770, 0.006698837, 0.012692587
#&gt; $ `2018-09-21` &lt;dbl&gt; 0.0003726642, 0.0082752213, 0.0026245042, -0.0003286405
#&gt; $ `2018-09-24` &lt;dbl&gt; -0.010072955, 0.013828416, -0.014558807, 0.006489045
#&gt; $ `2018-09-25` &lt;dbl&gt; -0.0034740979, 0.0079921453, -0.0056531970, -0.0008218263
#&gt; $ `2018-09-26` &lt;dbl&gt; -0.002645426, -0.009821787, -0.008520217, -0.002833221
#&gt; $ `2018-09-27` &lt;dbl&gt; -0.0009807794, -0.0002961086, 0.0010554973, 0.0055217433
#&gt; $ `2018-09-28` &lt;dbl&gt; -0.0007368244, 0.0005533699, 0.0117954826, 0.0020502699
#&gt; $ `2018-10-01` &lt;dbl&gt; 0.001618323, 0.013778724, -0.004743913, -0.004922243
#&gt; $ `2018-10-02` &lt;dbl&gt; -0.0021978236, -0.0008793832, 0.0063449319, -0.0096354843
#&gt; $ `2018-10-03` &lt;dbl&gt; 0.001595167, 0.013208412, -0.010963752, 0.003528746
#&gt; $ `2018-10-04` &lt;dbl&gt; -0.0056339596, -0.0075673719, 0.0005911404, -0.0233264347
#&gt; $ `2018-10-05` &lt;dbl&gt; -0.005892240, -0.002222662, 0.007115132, -0.017356286
#&gt; $ `2018-10-08` &lt;dbl&gt; 0.002315831, -0.004422415, 0.011777449, -0.016146227
#&gt; $ `2018-10-09` &lt;dbl&gt; -0.008888514, 0.011660485, 0.001382168, -0.002245737
#&gt; $ `2018-10-10` &lt;dbl&gt; -0.02905836, -0.04102685, -0.01068745, -0.04697040
#&gt; $ `2018-10-11` &lt;dbl&gt; -0.02220585, -0.03066850, -0.02451301, -0.01005558
#&gt; $ `2018-10-12` &lt;dbl&gt; 0.0079626327, 0.0059181717, 0.0009265891, 0.0285292180
#&gt; $ `2018-10-15` &lt;dbl&gt; 0.0003925018, -0.0069465232, 0.0063396100, -0.0109009681
#&gt; $ `2018-10-16` &lt;dbl&gt; 0.01900308, 0.01198762, 0.01495123, 0.03496553
#&gt; $ `2018-10-17` &lt;dbl&gt; -0.0022031050, -0.0121314041, -0.0014392965, -0.0001182299
#&gt; $ `2018-10-18` &lt;dbl&gt; -0.0143254165, -0.0110406026, 0.0003157027, -0.0250782664
#&gt; $ `2018-10-19` &lt;dbl&gt; -0.004171677, -0.013063143, 0.014528266, -0.012541599
#&gt; $ `2018-10-22` &lt;dbl&gt; -0.006903643, -0.010377735, -0.009878428, 0.003844884
#&gt; $ `2018-10-23` &lt;dbl&gt; -0.006763992, -0.029278040, 0.002693487, -0.003859615
#&gt; $ `2018-10-24` &lt;dbl&gt; -0.03132646, -0.04585749, 0.01353611, -0.05208563
#&gt; $ `2018-10-25` &lt;dbl&gt; 0.015441294, 0.015249528, -0.003340079, 0.028991360
#&gt; $ `2018-10-26` &lt;dbl&gt; -0.012819263, -0.009554609, -0.020372884, -0.023718562
#&gt; $ `2018-10-29` &lt;dbl&gt; 0.001596918, -0.024947273, 0.014181789, -0.018802822
#&gt; $ `2018-10-30` &lt;dbl&gt; 0.01998755, 0.02341653, 0.01125114, 0.03454404
#&gt; $ `2018-10-31` &lt;dbl&gt; 0.008027797, 0.006087733, -0.011297427, 0.021504480
#&gt; $ `2018-11-01` &lt;dbl&gt; 0.015634660, 0.010308997, 0.003747117, 0.032081398
#&gt; $ `2018-11-02` &lt;dbl&gt; -0.001293155, -0.009730453, -0.009108626, -0.003883827
#&gt; $ `2018-11-05` &lt;dbl&gt; 0.006938079, 0.018923407, 0.013772235, -0.005924196
#&gt; $ `2018-11-06` &lt;dbl&gt; 0.007426739, 0.002004953, 0.008152953, 0.005474840
#&gt; $ `2018-11-07` &lt;dbl&gt; 0.014704492, 0.022724471, 0.008792495, 0.027114895
#&gt; $ `2018-11-08` &lt;dbl&gt; 0.0004365969, -0.0277091571, 0.0004581358, -0.0034784146
#&gt; $ `2018-11-09` &lt;dbl&gt; -0.008675371, -0.004971914, 0.005367340, -0.024619687
#&gt; $ `2018-11-12` &lt;dbl&gt; -0.015211256, -0.029063167, 0.001904854, -0.033687808
#&gt; $ `2018-11-13` &lt;dbl&gt; 0.0008174817, -0.0251968257, 0.0001916946, 0.0041571717
#&gt; $ `2018-11-14` &lt;dbl&gt; -0.007268626, 0.003142088, -0.004133400, -0.005272713
#&gt; $ `2018-11-15` &lt;dbl&gt; 0.008872325, 0.020515330, -0.004406745, 0.023355178
#&gt; $ `2018-11-16` &lt;dbl&gt; 0.002216731, 0.007680349, 0.010063612, -0.005298491
#&gt; $ `2018-11-19` &lt;dbl&gt; -0.012261967, -0.006087903, 0.001588685, -0.044615610
#&gt; $ `2018-11-20` &lt;dbl&gt; -0.018868549, -0.040522927, -0.008086658, -0.007829112
#&gt; $ `2018-11-21` &lt;dbl&gt; 0.007797251, 0.018658251, -0.006933761, 0.012297653
#&gt; $ `2018-11-23` &lt;dbl&gt; -1.868033e-03, -3.653804e-02, -7.387090e-06, -2.928696e-03
#&gt; $ `2018-11-26` &lt;dbl&gt; 0.01391096, 0.02157185, 0.00222745, 0.02792190
#&gt; $ `2018-11-27` &lt;dbl&gt; -0.001218930, -0.006230058, 0.005847793, 0.000669214
#&gt; $ `2018-11-28` &lt;dbl&gt; 0.020257793, 0.016374453, 0.002822177, 0.032255508
#&gt; $ `2018-11-29` &lt;dbl&gt; -0.0037995937, 0.0053696702, 0.0002154275, -0.0073804570
#&gt; $ `2018-11-30` &lt;dbl&gt; 0.005229962, -0.006236157, 0.011292338, 0.008241973
#&gt; $ `2018-12-03` &lt;dbl&gt; 0.008915859, 0.026350978, 0.003797532, 0.021707438
#&gt; $ `2018-12-04` &lt;dbl&gt; -0.034976107, -0.035131989, -0.008022436, -0.044736643
#&gt; $ `2018-12-06` &lt;dbl&gt; -0.006218295, -0.025829610, 0.009630455, 0.008023883
#&gt; $ `2018-12-07` &lt;dbl&gt; -0.023407900, -0.007277311, -0.007000921, -0.037844459
#&gt; $ `2018-12-10` &lt;dbl&gt; -0.003215619, -0.022566657, -0.000701633, 0.009075633
#&gt; $ `2018-12-11` &lt;dbl&gt; -0.003893997, -0.003490909, 0.004753714, 0.001617522
#&gt; $ `2018-12-12` &lt;dbl&gt; 0.00769762, 0.01204804, -0.00950557, 0.01094937
#&gt; $ `2018-12-13` &lt;dbl&gt; -0.008218803, -0.002388297, 0.008867633, -0.009546741
#&gt; $ `2018-12-14` &lt;dbl&gt; -0.014658242, -0.028984553, -0.006215472, -0.020016222
#&gt; $ `2018-12-17` &lt;dbl&gt; -0.01759075, -0.01903142, -0.03181874, -0.02540093
#&gt; $ `2018-12-18` &lt;dbl&gt; -0.001704006, -0.022103904, -0.002335696, 0.010933420
#&gt; $ `2018-12-19` &lt;dbl&gt; -0.015390412, -0.013217782, -0.005963248, -0.029032982
#&gt; $ `2018-12-20` &lt;dbl&gt; -0.016571956, -0.028551975, -0.009304501, -0.017370866
#&gt; $ `2018-12-21` &lt;dbl&gt; -0.01838267, -0.01564321, -0.01104888, -0.03004544
#&gt; $ `2018-12-24` &lt;dbl&gt; -0.02226213, -0.04288499, -0.03925786, -0.02366252
#&gt; $ `2018-12-26` &lt;dbl&gt; 0.04534322, 0.07139516, 0.02519597, 0.06254006
#&gt; $ `2018-12-27` &lt;dbl&gt; 0.008903106, 0.003921202, 0.005720476, 0.010954290
#&gt; $ `2018-12-28` &lt;dbl&gt; -0.0019643956, -0.0097765403, 0.0005493469, -0.0021091840
#&gt; $ `2018-12-31` &lt;dbl&gt; 0.009390790, 0.006628301, 0.003374524, 0.008540171
#&gt; $ `2019-01-02` &lt;dbl&gt; 0.002999051, 0.019069103, -0.017623973, 0.003843006
#&gt; $ `2019-01-03` &lt;dbl&gt; -0.020498572, -0.007154041, 0.003428785, -0.042207626
#&gt; $ `2019-01-04` &lt;dbl&gt; 0.03395158, 0.04511775, 0.01352601, 0.04949310
#&gt; $ `2019-01-07` &lt;dbl&gt; 0.009397651, 0.020515467, 0.002960760, 0.021900070
#&gt; $ `2019-01-08` &lt;dbl&gt; 0.009803304, 0.011879849, 0.014579573, 0.011169862
#&gt; $ `2019-01-09` &lt;dbl&gt; 0.006131962, 0.021232497, -0.004437992, 0.017527869
#&gt; $ `2019-01-10` &lt;dbl&gt; 0.004161268, 0.007079545, 0.014320030, 0.006892676
#&gt; $ `2019-01-11` &lt;dbl&gt; 0.0019697839, -0.0044939986, 0.0006439650, -0.0000643815
#&gt; $ `2019-01-14` &lt;dbl&gt; -2.211265e-03, -5.779135e-05, -7.487770e-03, -1.263161e-02
#&gt; $ `2019-01-15` &lt;dbl&gt; 0.004755527, 0.004220701, 0.011233657, 0.016148265
#&gt; $ `2019-01-16` &lt;dbl&gt; 0.0034638122, 0.0005469789, 0.0018849468, -0.0003493891
#&gt; $ `2019-01-17` &lt;dbl&gt; 0.009621661, 0.013001543, 0.005550432, 0.009778713
#&gt; $ `2019-01-18` &lt;dbl&gt; 0.016372572, 0.020885746, 0.005066536, 0.018933426
#&gt; $ `2019-01-22` &lt;dbl&gt; -0.013525856, -0.026342440, -0.003042516, -0.022274543
#&gt; $ `2019-01-23` &lt;dbl&gt; 0.0008376363, -0.0139855530, 0.0054318391, -0.0051502604
#&gt; $ `2019-01-24` &lt;dbl&gt; 0.002910626, 0.002068247, -0.002902421, 0.025276525
#&gt; $ `2019-01-25` &lt;dbl&gt; 0.0104049820, 0.0200460247, -0.0007662691, 0.0213786649
#&gt; $ `2019-01-28` &lt;dbl&gt; -0.003409732, -0.015255646, 0.003788257, -0.011670435
#&gt; $ `2019-01-29` &lt;dbl&gt; 0.003457064, 0.006852493, 0.004292367, -0.013352553
#&gt; $ `2019-01-30` &lt;dbl&gt; 0.007812059, 0.020060173, 0.007180800, 0.025220812
#&gt; $ `2019-01-31` &lt;dbl&gt; 0.0051356841, -0.0004307433, 0.0144310699, 0.0100370290
#&gt; $ `2019-02-01` &lt;dbl&gt; 0.002655385, 0.008515918, -0.004675601, 0.008579466
#&gt; $ `2019-02-04` &lt;dbl&gt; 0.004837957, 0.006715036, 0.004866655, 0.006612912
#&gt; $ `2019-02-05` &lt;dbl&gt; 0.004876282, -0.001705462, 0.001337625, 0.007444096
#&gt; $ `2019-02-06` &lt;dbl&gt; -0.0007242068, -0.0072253794, -0.0032362265, 0.0011515879
#&gt; $ `2019-02-07` &lt;dbl&gt; -0.005505920, -0.032870943, 0.005879985, -0.016007614
#&gt; $ `2019-02-08` &lt;dbl&gt; 0.0003808557, -0.0073106553, 0.0041796637, 0.0108905276
#&gt; $ `2019-02-11` &lt;dbl&gt; 0.002443940, 0.009675432, 0.001155150, 0.002164051
#&gt; $ `2019-02-12` &lt;dbl&gt; 0.0144575364, 0.0109777684, -0.0007469276, 0.0187379927
#&gt; $ `2019-02-13` &lt;dbl&gt; 0.003986743, 0.018636127, 0.001301848, 0.002882583
#&gt; $ `2019-02-14` &lt;dbl&gt; -0.0036341950, 0.0069304497, -0.0018576514, 0.0008287979
#&gt; $ `2019-02-15` &lt;dbl&gt; 0.013290681, 0.016988955, 0.006505341, 0.003344893
#&gt; $ size         &lt;int&gt; 317, 30, 84, 71
#&gt; $ withinss     &lt;dbl&gt; 18.051976, 1.588895, 2.554867, 7.009809
#&gt; $ cluster      &lt;fct&gt; 1, 2, 3, 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(kmeans_obj_challenge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["totss"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["tot.withinss"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["betweenss"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["iter"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"33.60445","2":"29.20555","3":"4.398903","4":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Augment</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-11_f3d2d4ea742847d4383db4cac2d563d5">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Add the clusters to the data</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>broom<span class="sc">::</span><span class="fu">augment</span>(kmeans_obj_challenge, stock_date_matrix_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>    <span class="fu">select</span>(symbol, .cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".cluster"],"name":[2],"type":["fct"],"align":["left"]}],"data":[{"1":"A","2":"1"},{"1":"AAL","2":"4"},{"1":"AAP","2":"1"},{"1":"AAPL","2":"4"},{"1":"ABBV","2":"1"},{"1":"ABC","2":"1"},{"1":"ABMD","2":"4"},{"1":"ABT","2":"1"},{"1":"ACN","2":"1"},{"1":"ADBE","2":"4"},{"1":"ADI","2":"4"},{"1":"ADM","2":"1"},{"1":"ADP","2":"1"},{"1":"ADS","2":"1"},{"1":"ADSK","2":"4"},{"1":"AEE","2":"3"},{"1":"AEP","2":"3"},{"1":"AES","2":"3"},{"1":"AFL","2":"1"},{"1":"AGN","2":"1"},{"1":"AIG","2":"1"},{"1":"AIV","2":"3"},{"1":"AIZ","2":"1"},{"1":"AJG","2":"1"},{"1":"AKAM","2":"4"},{"1":"ALB","2":"1"},{"1":"ALGN","2":"4"},{"1":"ALK","2":"1"},{"1":"ALL","2":"1"},{"1":"ALLE","2":"1"},{"1":"ALXN","2":"4"},{"1":"AMAT","2":"4"},{"1":"AMD","2":"4"},{"1":"AME","2":"1"},{"1":"AMG","2":"1"},{"1":"AMGN","2":"1"},{"1":"AMP","2":"1"},{"1":"AMT","2":"3"},{"1":"AMZN","2":"4"},{"1":"ANET","2":"4"},{"1":"ANSS","2":"4"},{"1":"ANTM","2":"1"},{"1":"AON","2":"1"},{"1":"AOS","2":"1"},{"1":"APA","2":"2"},{"1":"APC","2":"2"},{"1":"APD","2":"1"},{"1":"APH","2":"1"},{"1":"APTV","2":"1"},{"1":"ARE","2":"3"},{"1":"ARNC","2":"1"},{"1":"ATO","2":"3"},{"1":"ATVI","2":"4"},{"1":"AVB","2":"3"},{"1":"AVGO","2":"4"},{"1":"AVY","2":"1"},{"1":"AWK","2":"3"},{"1":"AXP","2":"1"},{"1":"AZO","2":"1"},{"1":"BA","2":"1"},{"1":"BAC","2":"1"},{"1":"BAX","2":"1"},{"1":"BBT","2":"1"},{"1":"BBY","2":"1"},{"1":"BDX","2":"1"},{"1":"BEN","2":"1"},{"1":"BHF","2":"1"},{"1":"BHGE","2":"2"},{"1":"BIIB","2":"1"},{"1":"BK","2":"1"},{"1":"BKNG","2":"1"},{"1":"BLK","2":"1"},{"1":"BLL","2":"1"},{"1":"BMY","2":"1"},{"1":"BR","2":"1"},{"1":"BSX","2":"1"},{"1":"BWA","2":"1"},{"1":"BXP","2":"3"},{"1":"C","2":"1"},{"1":"CAG","2":"3"},{"1":"CAH","2":"1"},{"1":"CAT","2":"1"},{"1":"CB","2":"1"},{"1":"CBOE","2":"1"},{"1":"CBRE","2":"1"},{"1":"CBS","2":"1"},{"1":"CCI","2":"3"},{"1":"CDNS","2":"4"},{"1":"CE","2":"1"},{"1":"CELG","2":"1"},{"1":"CERN","2":"1"},{"1":"CF","2":"1"},{"1":"CFG","2":"1"},{"1":"CHD","2":"3"},{"1":"CHRW","2":"1"},{"1":"CHTR","2":"1"},{"1":"CI","2":"1"},{"1":"CINF","2":"1"},{"1":"CL","2":"3"},{"1":"CLX","2":"3"},{"1":"CMA","2":"1"},{"1":"CMCSA","2":"1"},{"1":"CME","2":"1"},{"1":"CMG","2":"1"},{"1":"CMI","2":"1"},{"1":"CMS","2":"3"},{"1":"CNC","2":"1"},{"1":"CNP","2":"3"},{"1":"COF","2":"1"},{"1":"COG","2":"1"},{"1":"COO","2":"1"},{"1":"COP","2":"2"},{"1":"COST","2":"1"},{"1":"COTY","2":"1"},{"1":"CPB","2":"3"},{"1":"CPRI","2":"1"},{"1":"CPRT","2":"1"},{"1":"CRM","2":"4"},{"1":"CSCO","2":"4"},{"1":"CSX","2":"1"},{"1":"CTAS","2":"1"},{"1":"CTL","2":"1"},{"1":"CTSH","2":"1"},{"1":"CTXS","2":"1"},{"1":"CVS","2":"1"},{"1":"CVX","2":"2"},{"1":"CXO","2":"2"},{"1":"D","2":"3"},{"1":"DAL","2":"1"},{"1":"DE","2":"1"},{"1":"DFS","2":"1"},{"1":"DG","2":"1"},{"1":"DGX","2":"1"},{"1":"DHI","2":"1"},{"1":"DHR","2":"1"},{"1":"DIS","2":"1"},{"1":"DISCA","2":"1"},{"1":"DISCK","2":"1"},{"1":"DISH","2":"1"},{"1":"DLR","2":"3"},{"1":"DLTR","2":"1"},{"1":"DOV","2":"1"},{"1":"DRE","2":"3"},{"1":"DRI","2":"1"},{"1":"DTE","2":"3"},{"1":"DUK","2":"3"},{"1":"DVA","2":"1"},{"1":"DVN","2":"2"},{"1":"DWDP","2":"1"},{"1":"DXC","2":"1"},{"1":"EA","2":"4"},{"1":"EBAY","2":"1"},{"1":"ECL","2":"1"},{"1":"ED","2":"3"},{"1":"EFX","2":"1"},{"1":"EIX","2":"3"},{"1":"EL","2":"1"},{"1":"EMN","2":"1"},{"1":"EMR","2":"1"},{"1":"EOG","2":"2"},{"1":"EQIX","2":"3"},{"1":"EQR","2":"3"},{"1":"ES","2":"3"},{"1":"ESS","2":"3"},{"1":"ETFC","2":"1"},{"1":"ETN","2":"1"},{"1":"ETR","2":"3"},{"1":"EVRG","2":"3"},{"1":"EW","2":"4"},{"1":"EXC","2":"3"},{"1":"EXPD","2":"1"},{"1":"EXPE","2":"1"},{"1":"EXR","2":"3"},{"1":"F","2":"1"},{"1":"FANG","2":"2"},{"1":"FAST","2":"1"},{"1":"FB","2":"4"},{"1":"FBHS","2":"1"},{"1":"FCX","2":"2"},{"1":"FDX","2":"1"},{"1":"FE","2":"3"},{"1":"FFIV","2":"4"},{"1":"FIS","2":"1"},{"1":"FISV","2":"1"},{"1":"FITB","2":"1"},{"1":"FL","2":"1"},{"1":"FLIR","2":"1"},{"1":"FLR","2":"2"},{"1":"FLS","2":"1"},{"1":"FLT","2":"1"},{"1":"FMC","2":"1"},{"1":"FOX","2":"1"},{"1":"FOXA","2":"1"},{"1":"FRC","2":"1"},{"1":"FRT","2":"3"},{"1":"FTI","2":"2"},{"1":"FTNT","2":"4"},{"1":"FTV","2":"1"},{"1":"GD","2":"1"},{"1":"GE","2":"1"},{"1":"GILD","2":"1"},{"1":"GIS","2":"3"},{"1":"GLW","2":"1"},{"1":"GM","2":"1"},{"1":"GOOG","2":"4"},{"1":"GOOGL","2":"4"},{"1":"GPC","2":"1"},{"1":"GPN","2":"4"},{"1":"GPS","2":"1"},{"1":"GRMN","2":"1"},{"1":"GS","2":"1"},{"1":"GT","2":"1"},{"1":"GWW","2":"1"},{"1":"HAL","2":"2"},{"1":"HAS","2":"1"},{"1":"HBAN","2":"1"},{"1":"HBI","2":"1"},{"1":"HCA","2":"1"},{"1":"HCP","2":"3"},{"1":"HD","2":"1"},{"1":"HES","2":"2"},{"1":"HFC","2":"2"},{"1":"HIG","2":"1"},{"1":"HII","2":"1"},{"1":"HLT","2":"1"},{"1":"HOG","2":"1"},{"1":"HOLX","2":"1"},{"1":"HON","2":"1"},{"1":"HP","2":"2"},{"1":"HPE","2":"4"},{"1":"HPQ","2":"1"},{"1":"HRB","2":"1"},{"1":"HRL","2":"3"},{"1":"HRS","2":"1"},{"1":"HSIC","2":"1"},{"1":"HST","2":"1"},{"1":"HSY","2":"3"},{"1":"HUM","2":"1"},{"1":"IBM","2":"1"},{"1":"ICE","2":"1"},{"1":"IDXX","2":"4"},{"1":"IFF","2":"1"},{"1":"ILMN","2":"4"},{"1":"INCY","2":"4"},{"1":"INFO","2":"1"},{"1":"INTC","2":"4"},{"1":"INTU","2":"4"},{"1":"IP","2":"1"},{"1":"IPG","2":"1"},{"1":"IPGP","2":"4"},{"1":"IQV","2":"1"},{"1":"IR","2":"1"},{"1":"IRM","2":"3"},{"1":"ISRG","2":"4"},{"1":"IT","2":"1"},{"1":"ITW","2":"1"},{"1":"IVZ","2":"1"},{"1":"JBHT","2":"1"},{"1":"JCI","2":"1"},{"1":"JEC","2":"1"},{"1":"JEF","2":"1"},{"1":"JKHY","2":"1"},{"1":"JNJ","2":"1"},{"1":"JNPR","2":"1"},{"1":"JPM","2":"1"},{"1":"JWN","2":"1"},{"1":"K","2":"3"},{"1":"KEY","2":"1"},{"1":"KEYS","2":"4"},{"1":"KHC","2":"3"},{"1":"KIM","2":"3"},{"1":"KLAC","2":"4"},{"1":"KMB","2":"3"},{"1":"KMI","2":"2"},{"1":"KMX","2":"1"},{"1":"KO","2":"3"},{"1":"KR","2":"1"},{"1":"KSS","2":"1"},{"1":"KSU","2":"1"},{"1":"L","2":"1"},{"1":"LB","2":"1"},{"1":"LEG","2":"1"},{"1":"LEN","2":"1"},{"1":"LH","2":"1"},{"1":"LIN","2":"1"},{"1":"LKQ","2":"1"},{"1":"LLL","2":"1"},{"1":"LLY","2":"1"},{"1":"LMT","2":"1"},{"1":"LNC","2":"1"},{"1":"LNT","2":"3"},{"1":"LOW","2":"1"},{"1":"LRCX","2":"4"},{"1":"LUV","2":"1"},{"1":"LW","2":"3"},{"1":"LYB","2":"1"},{"1":"M","2":"1"},{"1":"MA","2":"4"},{"1":"MAA","2":"3"},{"1":"MAC","2":"3"},{"1":"MAR","2":"1"},{"1":"MAS","2":"1"},{"1":"MAT","2":"4"},{"1":"MCD","2":"3"},{"1":"MCHP","2":"4"},{"1":"MCK","2":"1"},{"1":"MCO","2":"1"},{"1":"MDLZ","2":"3"},{"1":"MDT","2":"1"},{"1":"MET","2":"1"},{"1":"MGM","2":"4"},{"1":"MHK","2":"1"},{"1":"MKC","2":"3"},{"1":"MLM","2":"1"},{"1":"MMC","2":"1"},{"1":"MMM","2":"1"},{"1":"MNST","2":"1"},{"1":"MO","2":"3"},{"1":"MOS","2":"1"},{"1":"MPC","2":"2"},{"1":"MRK","2":"1"},{"1":"MRO","2":"2"},{"1":"MS","2":"1"},{"1":"MSCI","2":"4"},{"1":"MSFT","2":"4"},{"1":"MSI","2":"1"},{"1":"MTB","2":"1"},{"1":"MTD","2":"1"},{"1":"MU","2":"4"},{"1":"MXIM","2":"4"},{"1":"MYL","2":"1"},{"1":"NBL","2":"2"},{"1":"NCLH","2":"1"},{"1":"NDAQ","2":"1"},{"1":"NEE","2":"3"},{"1":"NEM","2":"1"},{"1":"NFLX","2":"4"},{"1":"NI","2":"3"},{"1":"NKE","2":"1"},{"1":"NKTR","2":"4"},{"1":"NLSN","2":"1"},{"1":"NOC","2":"1"},{"1":"NOV","2":"2"},{"1":"NRG","2":"3"},{"1":"NSC","2":"1"},{"1":"NTAP","2":"4"},{"1":"NTRS","2":"1"},{"1":"NUE","2":"1"},{"1":"NVDA","2":"4"},{"1":"NWL","2":"1"},{"1":"NWS","2":"1"},{"1":"NWSA","2":"1"},{"1":"O","2":"3"},{"1":"OKE","2":"2"},{"1":"OMC","2":"1"},{"1":"ORCL","2":"1"},{"1":"ORLY","2":"1"},{"1":"OXY","2":"2"},{"1":"PAYX","2":"1"},{"1":"PBCT","2":"1"},{"1":"PCAR","2":"1"},{"1":"PEG","2":"3"},{"1":"PEP","2":"3"},{"1":"PFE","2":"1"},{"1":"PFG","2":"1"},{"1":"PG","2":"3"},{"1":"PGR","2":"1"},{"1":"PH","2":"1"},{"1":"PHM","2":"1"},{"1":"PKG","2":"1"},{"1":"PKI","2":"1"},{"1":"PLD","2":"3"},{"1":"PM","2":"3"},{"1":"PNC","2":"1"},{"1":"PNR","2":"1"},{"1":"PNW","2":"3"},{"1":"PPG","2":"1"},{"1":"PPL","2":"3"},{"1":"PRGO","2":"1"},{"1":"PRU","2":"1"},{"1":"PSA","2":"3"},{"1":"PSX","2":"2"},{"1":"PVH","2":"1"},{"1":"PWR","2":"1"},{"1":"PXD","2":"2"},{"1":"PYPL","2":"4"},{"1":"QCOM","2":"1"},{"1":"QRVO","2":"4"},{"1":"RCL","2":"1"},{"1":"RE","2":"1"},{"1":"REG","2":"3"},{"1":"REGN","2":"1"},{"1":"RF","2":"1"},{"1":"RHI","2":"4"},{"1":"RHT","2":"1"},{"1":"RJF","2":"1"},{"1":"RL","2":"1"},{"1":"RMD","2":"1"},{"1":"ROK","2":"1"},{"1":"ROL","2":"1"},{"1":"ROP","2":"1"},{"1":"ROST","2":"1"},{"1":"RSG","2":"1"},{"1":"RTN","2":"1"},{"1":"SBAC","2":"3"},{"1":"SBUX","2":"1"},{"1":"SCHW","2":"1"},{"1":"SEE","2":"1"},{"1":"SHW","2":"1"},{"1":"SIVB","2":"1"},{"1":"SJM","2":"3"},{"1":"SLB","2":"2"},{"1":"SLG","2":"3"},{"1":"SNA","2":"1"},{"1":"SNPS","2":"4"},{"1":"SO","2":"3"},{"1":"SPG","2":"3"},{"1":"SPGI","2":"1"},{"1":"SRE","2":"3"},{"1":"STI","2":"1"},{"1":"STT","2":"1"},{"1":"STX","2":"4"},{"1":"STZ","2":"1"},{"1":"SWK","2":"1"},{"1":"SWKS","2":"4"},{"1":"SYF","2":"1"},{"1":"SYK","2":"1"},{"1":"SYMC","2":"4"},{"1":"SYY","2":"3"},{"1":"T","2":"1"},{"1":"TAP","2":"3"},{"1":"TDG","2":"1"},{"1":"TEL","2":"1"},{"1":"TFX","2":"1"},{"1":"TGT","2":"1"},{"1":"TIF","2":"1"},{"1":"TJX","2":"1"},{"1":"TMK","2":"1"},{"1":"TMO","2":"1"},{"1":"TPR","2":"1"},{"1":"TRIP","2":"4"},{"1":"TROW","2":"1"},{"1":"TRV","2":"1"},{"1":"TSCO","2":"1"},{"1":"TSN","2":"3"},{"1":"TSS","2":"4"},{"1":"TTWO","2":"4"},{"1":"TWTR","2":"4"},{"1":"TXN","2":"4"},{"1":"TXT","2":"1"},{"1":"UA","2":"4"},{"1":"UAA","2":"4"},{"1":"UAL","2":"1"},{"1":"UDR","2":"3"},{"1":"UHS","2":"1"},{"1":"ULTA","2":"1"},{"1":"UNH","2":"1"},{"1":"UNM","2":"1"},{"1":"UNP","2":"1"},{"1":"UPS","2":"1"},{"1":"URI","2":"4"},{"1":"USB","2":"1"},{"1":"UTX","2":"1"},{"1":"V","2":"4"},{"1":"VAR","2":"1"},{"1":"VFC","2":"1"},{"1":"VIAB","2":"1"},{"1":"VLO","2":"2"},{"1":"VMC","2":"1"},{"1":"VNO","2":"3"},{"1":"VRSK","2":"1"},{"1":"VRSN","2":"4"},{"1":"VRTX","2":"4"},{"1":"VTR","2":"3"},{"1":"VZ","2":"3"},{"1":"WAT","2":"1"},{"1":"WBA","2":"1"},{"1":"WCG","2":"1"},{"1":"WDC","2":"4"},{"1":"WEC","2":"3"},{"1":"WELL","2":"3"},{"1":"WFC","2":"1"},{"1":"WHR","2":"1"},{"1":"WLTW","2":"1"},{"1":"WM","2":"3"},{"1":"WMB","2":"2"},{"1":"WMT","2":"1"},{"1":"WRK","2":"1"},{"1":"WU","2":"1"},{"1":"WY","2":"3"},{"1":"WYNN","2":"4"},{"1":"XEC","2":"2"},{"1":"XEL","2":"3"},{"1":"XLNX","2":"4"},{"1":"XOM","2":"2"},{"1":"XRAY","2":"1"},{"1":"XRX","2":"1"},{"1":"XYL","2":"1"},{"1":"YUM","2":"1"},{"1":"ZBH","2":"1"},{"1":"ZION","2":"1"},{"1":"ZTS","2":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Map Clusters</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-12_244d522aeb2e4861943e98e2d0ea5c66">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>kmeans_mapper <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">centers =</span> <span class="dv">4</span>) {</span>
<span id="cb33-2"><a href="#cb33-2"></a>    </span>
<span id="cb33-3"><a href="#cb33-3"></a>    stock_date_matrix_tbl <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>        <span class="fu">select</span>(<span class="sc">-</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>        <span class="fu">kmeans</span>(<span class="at">centers =</span> centers, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a>}</span>
<span id="cb33-7"><a href="#cb33-7"></a></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="dv">4</span> <span class="sc">%&gt;%</span> <span class="fu">kmeans_mapper</span>() <span class="sc">%&gt;%</span> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["totss"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["tot.withinss"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["betweenss"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["iter"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"33.60445","2":"29.20555","3":"4.398903","4":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Map function to many elements</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-13_d79e72f931ab67103054ac31f354dfe6">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Mapping the function to many elements</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>kmeans_mapped_tbl_challenge <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">centers =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>    <span class="fu">mutate</span>(<span class="at">k_means =</span> centers <span class="sc">%&gt;%</span> <span class="fu">map</span>(kmeans_mapper)) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="fu">mutate</span>(<span class="at">glance  =</span> k_means <span class="sc">%&gt;%</span> <span class="fu">map</span>(glance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: There was 1 warning in `mutate()`.
#&gt; ℹ In argument: `k_means = centers %&gt;% map(kmeans_mapper)`.
#&gt; Caused by warning:
#&gt; ! keine Konvergenz nach 10 Schritten</code></pre>
</div>
</div>
<p><strong>tot.wihinss</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-14_32447843305e8592fd3826f5f72ab124">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>kmeans_mapped_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>    <span class="fu">unnest</span>(glance) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>    <span class="fu">select</span>(centers, tot.withinss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["centers"],"name":[1],"type":["int"],"align":["right"]},{"label":["tot.withinss"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"33.60445"},{"1":"2","2":"31.40409"},{"1":"3","2":"30.17267"},{"1":"4","2":"29.20555"},{"1":"5","2":"28.56583"},{"1":"6","2":"27.95312"},{"1":"7","2":"27.40040"},{"1":"8","2":"26.88369"},{"1":"9","2":"26.40884"},{"1":"10","2":"26.02261"},{"1":"11","2":"25.63226"},{"1":"12","2":"25.28993"},{"1":"13","2":"25.04133"},{"1":"14","2":"24.73658"},{"1":"15","2":"24.46321"},{"1":"16","2":"24.20307"},{"1":"17","2":"23.95787"},{"1":"18","2":"23.69702"},{"1":"19","2":"23.47777"},{"1":"20","2":"23.18989"},{"1":"21","2":"22.98957"},{"1":"22","2":"22.69844"},{"1":"23","2":"22.53542"},{"1":"24","2":"22.36038"},{"1":"25","2":"22.08388"},{"1":"26","2":"21.90308"},{"1":"27","2":"21.73192"},{"1":"28","2":"21.50888"},{"1":"29","2":"21.33802"},{"1":"30","2":"21.12765"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Skree PLot</strong></p>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-15_f68f782b882432ffb2ac1eb395f1b550">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co">#Skree Plot ----</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>kmeans_mapped_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>    <span class="fu">unnest</span>(glance) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>    <span class="fu">select</span>(centers, tot.withinss) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>    </span>
<span id="cb37-7"><a href="#cb37-7"></a>    <span class="co"># Visualization</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(centers, tot.withinss)) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#2DC6D6"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#2DC6D6"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>    <span class="co"># Add labels (which are repelled a little)</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> centers), <span class="at">color =</span> <span class="st">"#2DC6D6"</span>) <span class="sc">+</span> </span>
<span id="cb37-13"><a href="#cb37-13"></a>    </span>
<span id="cb37-14"><a href="#cb37-14"></a>    <span class="co"># Formatting</span></span>
<span id="cb37-15"><a href="#cb37-15"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Skree Plot"</span>,</span>
<span id="cb37-16"><a href="#cb37-16"></a>    <span class="at">subtitle =</span> <span class="st">"Measures the distance each of the customer are from the closes K-Means center"</span>,</span>
<span id="cb37-17"><a href="#cb37-17"></a>    <span class="at">caption =</span> <span class="st">"Conclusion: Based on the Scree Plot, we select 4 clusters to segment the customer base."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
#&gt; ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_fundamental_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="01_fundamental_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="umap" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> UMAP</h1>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-16_88e33d83bfe4e92fb1b3b0af7662ead7">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>umap_obj_challenge <span class="ot">&lt;-</span> stock_date_matrix_tbl <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>    <span class="fu">select</span>(<span class="sc">-</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>    <span class="fu">umap</span>()</span>
<span id="cb39-4"><a href="#cb39-4"></a>    </span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="fu">options</span>(<span class="at">ggrepel.max.overlaps =</span> <span class="cn">Inf</span>) <span class="co"># To ignore overlaps</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="fu">library</span>(tidyquant) <span class="co"># TO use tq_theme()</span></span>
<span id="cb39-7"><a href="#cb39-7"></a></span>
<span id="cb39-8"><a href="#cb39-8"></a>umap_results_tbl_challenge <span class="ot">&lt;-</span> umap_obj_challenge<span class="sc">$</span>layout <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>    <span class="fu">as_tibble</span>(<span class="at">.name_repair =</span> <span class="st">"unique"</span>) <span class="sc">%&gt;%</span> <span class="co"># argument is required to set names in the next step</span></span>
<span id="cb39-10"><a href="#cb39-10"></a>    <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb39-12"><a href="#cb39-12"></a>        stock_date_matrix_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(symbol)</span>
<span id="cb39-13"><a href="#cb39-13"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>umap_results_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>    <span class="fu">theme_tq</span>() <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb41-5"><a href="#cb41-5"></a>    <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> symbol), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>    <span class="fu">labs</span>(</span>
<span id="cb41-7"><a href="#cb41-7"></a>        <span class="at">title =</span> <span class="st">"UMAP Projection"</span>,</span>
<span id="cb41-8"><a href="#cb41-8"></a>        <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb41-9"><a href="#cb41-9"></a>        <span class="at">fill =</span> <span class="st">""</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_fundamental_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="01_fundamental_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-17_7afb978fd699a5ae132d79e93a1fd3a6">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Get the data for the third element (which we have chosen in the skree plot)</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>kmeans_3_obj <span class="ot">&lt;-</span> kmeans_mapped_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>    <span class="fu">pull</span>(k_means) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>    <span class="fu">pluck</span>(<span class="dv">4</span>)</span>
<span id="cb42-5"><a href="#cb42-5"></a></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="co"># Convert it to a tibble with broom</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>kmeans_3_clusters_tbl_challenge <span class="ot">&lt;-</span> kmeans_3_obj <span class="sc">%&gt;%</span> </span>
<span id="cb42-8"><a href="#cb42-8"></a>    <span class="fu">augment</span>(stock_date_matrix_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>    <span class="co"># Select the data we need</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>    <span class="fu">select</span>(symbol, .cluster)</span>
<span id="cb42-11"><a href="#cb42-11"></a></span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="co"># Bind data together</span></span>
<span id="cb42-13"><a href="#cb42-13"></a>umap_kmeans_3_results_tbl_challenge <span class="ot">&lt;-</span> umap_results_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="#cb42-14"></a>    <span class="fu">left_join</span>(kmeans_3_clusters_tbl_challenge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Joining with `by = join_by(symbol)`</code></pre>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-18_c9d254df04ac8eab4a163b7e107be201">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>umap_kmeans_3_results_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>    <span class="fu">mutate</span>(<span class="at">label_text =</span> <span class="fu">str_glue</span>(<span class="st">"Company: {symbol}</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="st">                                 Cluster: {.cluster}"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>    </span>
<span id="cb44-5"><a href="#cb44-5"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">color =</span> .cluster)) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>    </span>
<span id="cb44-7"><a href="#cb44-7"></a>    <span class="co"># Geometries</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>    <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_text), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#282A36"</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>    </span>
<span id="cb44-11"><a href="#cb44-11"></a>    <span class="co"># Formatting</span></span>
<span id="cb44-12"><a href="#cb44-12"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#2d72d6"</span>, <span class="st">"#2dc6d6"</span>, <span class="st">"#2dd692"</span>, <span class="st">"#09d3c2"</span>)) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Customer Segmentation: 2D Projection"</span>,</span>
<span id="cb44-14"><a href="#cb44-14"></a>    <span class="at">subtitle =</span> <span class="st">"UMAP 2D Projection with K-Means Cluster Assignment"</span>,</span>
<span id="cb44-15"><a href="#cb44-15"></a>    <span class="at">caption =</span> <span class="st">"Conclusion: 4 Company Segments identified using 2 algorithms"</span>) <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_fundamental_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="01_fundamental_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-clustering-for-10-centers" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> <strong>K means clustering for 10 centers</strong></h1>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-19_b0597db5d4bde40321495c07dc0ce737">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>kmeans_obj_challenge_10 <span class="ot">&lt;-</span> stock_date_matrix_tbl <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>    <span class="fu">select</span>(<span class="sc">-</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>    <span class="fu">kmeans</span>(<span class="at">centers =</span> <span class="dv">10</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb45-4"><a href="#cb45-4"></a>kmeans_obj_challenge_10<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   [1]  2  7 10  2  9  9  2  9  9  2  3  9  9  7  2  1  1  1  9  9  8  1  9  9  2
#&gt;  [26]  7  2  7  9  7  2  3  3  7  8  9  8  1  2  2  2  9  9  7  6  6  7  9  7  1
#&gt;  [51]  7  1  2  1  3  7  1  8 10  7  8  9  8 10  9  8  8  6  9  8  2  8  9  9  9
#&gt;  [76]  9  7  1  8  1  9  7  9  9  7  9  1  2  7  9  9  2  8  1  7  9  9  9  1  1
#&gt; [101]  8  9  9 10  7  1  9  1  8  9  9  6  9  4  1 10  2  2  2  7  9  9  9  9  9
#&gt; [126]  6  6  1  7  7  8 10  9  7  9  9  9  9  7  1 10  7  1  9  1  1  9  6  7  9
#&gt; [151]  2  9  9  1  9  1  9  7  7  6  1  1  1  1  8  7  1  1  2  1  7  9  1  7  6
#&gt; [176]  7  2  7  6  7  1  2  9  9  8 10  9  7  7  2  7  9  9  8  1  6  2  7  7  9
#&gt; [201]  9  1  7  7  2  2  9  2 10  9  8  7  7  6  9  8 10  9  1  9  6  6  9  7  7
#&gt; [226]  7  9  7  6  9  7  9  1  7  9  9  1  9  9  9  2  9  2  2  9  3  2  7  9  3
#&gt; [251]  2  7  1  2  9  7  8  7  7  7  8  9  9  9  8 10  1  8  2  1  1  3  1  6  9
#&gt; [276]  1 10 10  7  9 10  7  7  9  9  7  7  9  7  8  1 10  3  7  9  7 10  2  1  1
#&gt; [301]  7  7  4  9  3  9  9  1  9  8  7  7  1  7  9  7  9  1  7  6  9  6  8  2  2
#&gt; [326]  9  8  9  3  3  7  6  7  9  1  9  2  1  9  5  9  7  6  9  7  2  8  7  3  7
#&gt; [351]  9  9  1  6  9  9 10  6  9  8  7  1  1  9  8  1  9  7  7  7  2  1  1  8  7
#&gt; [376]  1  7  1  7  8  1  6 10  7  6  2  7  3  7  9  1  9  8  2 10  8 10  9  7  9
#&gt; [401]  7 10  9  7  1  9  8  7  7  8  1  6  1  7  2  1  1  9  1  8  8  3  9  7  3
#&gt; [426]  8  9  2  9  9  9  7  7  9 10 10 10  8  9 10  2  8  9 10  1  2  2  2  3  7
#&gt; [451]  4  4  7  1  9 10  9  8  7  7  7  8  7  2  9 10  9  6  7  1  9  2  2  1  1
#&gt; [476]  9  9  9  3  1  1  8  7  9  9  6  9  7  9  9  7  6  1  3  6  9  7  7  9  9
#&gt; [501]  8  9</code></pre>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-20_a40858e59450bf46bf32a7c2715dbaba">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(kmeans_obj_challenge_10) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 10
#&gt; Columns: 285
#&gt; $ `2018-01-03` &lt;dbl&gt; -0.0039409099, 0.0130856804, 0.0183475959, 0.0196614543, …
#&gt; $ `2018-01-04` &lt;dbl&gt; -0.007968797, 0.002606623, 0.007767855, 0.009614592, 0.00…
#&gt; $ `2018-01-05` &lt;dbl&gt; 0.0008863595, 0.0116709477, 0.0054604034, 0.0083596086, -…
#&gt; $ `2018-01-08` &lt;dbl&gt; 0.0052543639, 0.0075435192, 0.0146389642, -0.0053177686, …
#&gt; $ `2018-01-09` &lt;dbl&gt; -0.009256721, 0.001553862, -0.009733668, -0.021632842, 0.…
#&gt; $ `2018-01-10` &lt;dbl&gt; -0.0128986676, -0.0001220931, -0.0102919072, -0.006726448…
#&gt; $ `2018-01-11` &lt;dbl&gt; -0.005513756, 0.007896367, 0.009566329, 0.004202749, 0.01…
#&gt; $ `2018-01-12` &lt;dbl&gt; -0.006036916, 0.009659940, 0.008373945, -0.002665092, 0.0…
#&gt; $ `2018-01-16` &lt;dbl&gt; 0.001882245, -0.008963494, -0.001182828, -0.058360697, -0…
#&gt; $ `2018-01-17` &lt;dbl&gt; 0.007797652, 0.010189545, 0.029855162, 0.002897018, -0.00…
#&gt; $ `2018-01-18` &lt;dbl&gt; -0.0066607400, 0.0013684066, 0.0039774498, -0.0099325229,…
#&gt; $ `2018-01-19` &lt;dbl&gt; 0.004113943, 0.008031211, -0.002021784, 0.040441835, 0.02…
#&gt; $ `2018-01-22` &lt;dbl&gt; 0.007270843, 0.007799791, 0.003250657, 0.017956822, 0.072…
#&gt; $ `2018-01-23` &lt;dbl&gt; 0.0086166400, 0.0060518810, 0.0110756268, 0.0379076882, 0…
#&gt; $ `2018-01-24` &lt;dbl&gt; -0.0046195395, -0.0015674092, -0.0223315282, -0.012224546…
#&gt; $ `2018-01-25` &lt;dbl&gt; 0.006233310, 0.002170092, -0.016416816, -0.022253350, 0.0…
#&gt; $ `2018-01-26` &lt;dbl&gt; 0.0004465368, 0.0148716009, 0.0314992691, -0.0013154269, …
#&gt; $ `2018-01-29` &lt;dbl&gt; -0.011502404, -0.006658737, 0.000974843, -0.016453175, 0.…
#&gt; $ `2018-01-30` &lt;dbl&gt; -0.0022309658, -0.0074733311, -0.0182163890, -0.012973443…
#&gt; $ `2018-01-31` &lt;dbl&gt; 0.011540412, 0.004990203, 0.011053760, -0.010484817, 0.01…
#&gt; $ `2018-02-01` &lt;dbl&gt; -0.0156160026, 0.0001565540, 0.0024244727, -0.0190634365,…
#&gt; $ `2018-02-02` &lt;dbl&gt; -0.012704363, -0.021631867, -0.032484099, -0.002076577, -…
#&gt; $ `2018-02-05` &lt;dbl&gt; -0.02522776, -0.03502616, -0.04699533, -0.03945030, -0.06…
#&gt; $ `2018-02-06` &lt;dbl&gt; -0.001505741, 0.021241460, 0.039179036, 0.018994374, -0.0…
#&gt; $ `2018-02-07` &lt;dbl&gt; -0.0052776972, -0.0033516497, -0.0238146505, 0.0080707901…
#&gt; $ `2018-02-08` &lt;dbl&gt; -0.01887476, -0.04167277, -0.04082810, 0.01438555, -0.025…
#&gt; $ `2018-02-09` &lt;dbl&gt; 0.0199360907, 0.0180646058, 0.0258597843, 0.0408664979, -…
#&gt; $ `2018-02-12` &lt;dbl&gt; 0.004511781, 0.017098336, 0.021793312, 0.031525687, 0.054…
#&gt; $ `2018-02-13` &lt;dbl&gt; 0.0044227646, 0.0077459807, 0.0012232837, 0.0707301121, -…
#&gt; $ `2018-02-14` &lt;dbl&gt; -0.005742287, 0.022341359, 0.023740050, 0.040448433, 0.11…
#&gt; $ `2018-02-15` &lt;dbl&gt; 0.016808410, 0.018744059, 0.012220995, 0.025453792, -0.02…
#&gt; $ `2018-02-16` &lt;dbl&gt; 0.0054157719, -0.0041808602, -0.0055841551, -0.0327184475…
#&gt; $ `2018-02-20` &lt;dbl&gt; -0.0120474106, 0.0017583225, 0.0196961403, -0.0132688464,…
#&gt; $ `2018-02-21` &lt;dbl&gt; -0.0170272235, -0.0041471950, -0.0079850126, 0.0006828019…
#&gt; $ `2018-02-22` &lt;dbl&gt; 0.007523142, -0.002938726, -0.002855690, -0.018994639, 0.…
#&gt; $ `2018-02-23` &lt;dbl&gt; 0.01805507, 0.01946751, 0.02329817, 0.01273791, 0.0157578…
#&gt; $ `2018-02-26` &lt;dbl&gt; 0.0025238939, 0.0083194611, 0.0190284417, -0.0045193885, …
#&gt; $ `2018-02-27` &lt;dbl&gt; -0.017582088, -0.010661539, -0.003791504, -0.022410596, -…
#&gt; $ `2018-02-28` &lt;dbl&gt; -0.004833714, -0.003089604, -0.007267880, -0.010970884, -…
#&gt; $ `2018-03-01` &lt;dbl&gt; -0.0006516222, -0.0125674168, -0.0137645731, -0.022007310…
#&gt; $ `2018-03-02` &lt;dbl&gt; 0.0007408851, 0.0162011508, 0.0170787410, 0.0449641008, 0…
#&gt; $ `2018-03-05` &lt;dbl&gt; 0.014278210, 0.016212389, 0.011736888, 0.007615378, -0.00…
#&gt; $ `2018-03-06` &lt;dbl&gt; -2.850364e-03, 4.440269e-03, 1.990829e-02, 4.742766e-03, …
#&gt; $ `2018-03-07` &lt;dbl&gt; -0.0020955945, 0.0108110556, 0.0035626601, -0.0145753490,…
#&gt; $ `2018-03-08` &lt;dbl&gt; 0.0069857157, 0.0066054353, 0.0051256355, -0.0052765302, …
#&gt; $ `2018-03-09` &lt;dbl&gt; 0.0039814513, 0.0186316242, 0.0210383274, -0.0200553581, …
#&gt; $ `2018-03-12` &lt;dbl&gt; 0.0035160869, 0.0001364721, 0.0135134222, 0.0027151220, -…
#&gt; $ `2018-03-13` &lt;dbl&gt; 0.0011829044, -0.0108484789, -0.0108252976, -0.0283910751…
#&gt; $ `2018-03-14` &lt;dbl&gt; 0.001301140, 0.002926404, -0.002948935, -0.024853761, 0.0…
#&gt; $ `2018-03-15` &lt;dbl&gt; -0.0034186065, -0.0007298396, -0.0035655355, -0.017452364…
#&gt; $ `2018-03-16` &lt;dbl&gt; 0.006000956, -0.001164398, 0.002601348, 0.012805837, 0.00…
#&gt; $ `2018-03-19` &lt;dbl&gt; -0.007678512, -0.018399301, -0.016925151, -0.015527328, 0…
#&gt; $ `2018-03-20` &lt;dbl&gt; -0.0040207812, 0.0047607724, 0.0047636887, -0.0109413440,…
#&gt; $ `2018-03-21` &lt;dbl&gt; -0.009474201, -0.001841900, 0.002493637, -0.003123486, -0…
#&gt; $ `2018-03-22` &lt;dbl&gt; -0.002793654, -0.026045377, -0.027923195, -0.010070408, -…
#&gt; $ `2018-03-23` &lt;dbl&gt; -0.013355613, -0.022376092, -0.037932355, 0.005586658, -0…
#&gt; $ `2018-03-26` &lt;dbl&gt; 0.01191669, 0.03202677, 0.03798933, 0.02901152, 0.0391262…
#&gt; $ `2018-03-27` &lt;dbl&gt; 0.008781738, -0.032293858, -0.037722501, -0.004907839, -0…
#&gt; $ `2018-03-28` &lt;dbl&gt; 0.0118052652, -0.0100833332, -0.0189955997, -0.0061949106…
#&gt; $ `2018-03-29` &lt;dbl&gt; 0.004145154, 0.017864906, 0.022534680, 0.004764184, 0.011…
#&gt; $ `2018-04-02` &lt;dbl&gt; -0.01455033, -0.02587229, -0.03820582, -0.02008524, -0.07…
#&gt; $ `2018-04-03` &lt;dbl&gt; 0.007384861, 0.008783418, 0.018261238, 0.034235146, 0.005…
#&gt; $ `2018-04-04` &lt;dbl&gt; 0.0103070927, 0.0135754328, 0.0138059164, 0.0327929895, 0…
#&gt; $ `2018-04-05` &lt;dbl&gt; 0.002387612, 0.007245870, -0.010930948, -0.010307551, -0.…
#&gt; $ `2018-04-06` &lt;dbl&gt; -0.007518082, -0.028295270, -0.032341243, -0.018687501, -…
#&gt; $ `2018-04-09` &lt;dbl&gt; -0.0003290882, 0.0085652665, 0.0036532078, -0.0107724779,…
#&gt; $ `2018-04-10` &lt;dbl&gt; -0.002962699, 0.024001450, 0.033320576, 0.011116855, -0.0…
#&gt; $ `2018-04-11` &lt;dbl&gt; -0.0007242703, -0.0067060359, -0.0023040745, 0.0194276384…
#&gt; $ `2018-04-12` &lt;dbl&gt; -0.0112995176, 0.0130029370, 0.0187978809, 0.0102286064, …
#&gt; $ `2018-04-13` &lt;dbl&gt; 0.005874237, -0.004887050, -0.006594541, -0.024313246, -0…
#&gt; $ `2018-04-16` &lt;dbl&gt; 0.008667961, 0.006285140, 0.003885624, 0.001783420, -0.06…
#&gt; $ `2018-04-17` &lt;dbl&gt; 0.007649095, 0.025344068, 0.020622567, -0.009204711, 0.00…
#&gt; $ `2018-04-18` &lt;dbl&gt; -0.0048711174, 0.0051107954, -0.0089972139, -0.0167710481…
#&gt; $ `2018-04-19` &lt;dbl&gt; -0.014322088, -0.008980495, -0.039804836, -0.015619790, -…
#&gt; $ `2018-04-20` &lt;dbl&gt; -0.012403345, -0.010736368, -0.008709892, -0.015123451, -…
#&gt; $ `2018-04-23` &lt;dbl&gt; 0.0008585881, -0.0022429865, -0.0161618504, 0.0353373495,…
#&gt; $ `2018-04-24` &lt;dbl&gt; 0.002788421, -0.019054274, -0.011856441, 0.007331051, -0.…
#&gt; $ `2018-04-25` &lt;dbl&gt; 0.0001150323, -0.0037183541, -0.0006111281, -0.0203806437…
#&gt; $ `2018-04-26` &lt;dbl&gt; 0.010275975, 0.021981916, 0.026059218, 0.025117139, 0.019…
#&gt; $ `2018-04-27` &lt;dbl&gt; 0.012722723, -0.003837053, -0.012002997, 0.030197880, -0.…
#&gt; $ `2018-04-30` &lt;dbl&gt; -0.006063137, -0.002649181, -0.010622500, 0.014655499, 0.…
#&gt; $ `2018-05-01` &lt;dbl&gt; 0.0013244451, 0.0088218137, 0.0209240666, -0.0021541395, …
#&gt; $ `2018-05-02` &lt;dbl&gt; -0.008256095, -0.003197534, -0.006056481, 0.001715860, 0.…
#&gt; $ `2018-05-03` &lt;dbl&gt; 1.401028e-03, 6.080216e-03, 7.806590e-03, -3.565844e-02, …
#&gt; $ `2018-05-04` &lt;dbl&gt; 0.011139894, 0.012645177, 0.023414026, 0.005718492, -0.06…
#&gt; $ `2018-05-07` &lt;dbl&gt; -0.0009419860, 0.0091007575, 0.0085804275, 0.0262778717, …
#&gt; $ `2018-05-08` &lt;dbl&gt; -0.012701240, 0.002573573, 0.006524607, 0.004024818, -0.0…
#&gt; $ `2018-05-09` &lt;dbl&gt; 0.001962214, 0.019855365, 0.016856153, -0.013015150, -0.0…
#&gt; $ `2018-05-10` &lt;dbl&gt; 0.009207149, 0.009771848, 0.017313109, -0.002490280, -0.0…
#&gt; $ `2018-05-11` &lt;dbl&gt; -0.001314648, -0.003002117, -0.007204615, 0.009526900, 0.…
#&gt; $ `2018-05-14` &lt;dbl&gt; -0.0057579920, -0.0001589884, 0.0137659087, -0.0220298167…
#&gt; $ `2018-05-15` &lt;dbl&gt; -0.011862503, -0.008642441, -0.006568094, 0.026932336, 0.…
#&gt; $ `2018-05-16` &lt;dbl&gt; -0.0025997074, -0.0005672868, 0.0170826040, 0.0537275415,…
#&gt; $ `2018-05-17` &lt;dbl&gt; -0.0052819530, -0.0005936284, -0.0061068202, -0.017038617…
#&gt; $ `2018-05-18` &lt;dbl&gt; -0.0043447765, 0.0026264871, -0.0180986904, -0.0064112968…
#&gt; $ `2018-05-21` &lt;dbl&gt; 0.006031219, 0.004552501, 0.012379237, -0.005686704, -0.0…
#&gt; $ `2018-05-22` &lt;dbl&gt; 0.003060712, -0.005758573, 0.007774566, -0.005045261, -0.…
#&gt; $ `2018-05-23` &lt;dbl&gt; 0.0089572981, 0.0081701459, 0.0027023136, 0.0043962113, 0…
#&gt; $ `2018-05-24` &lt;dbl&gt; 8.245166e-04, -3.715844e-04, 3.909656e-03, 1.052968e-02, …
#&gt; $ `2018-05-25` &lt;dbl&gt; 0.0051204407, -0.0013014817, 0.0045611319, 0.0126268356, …
#&gt; $ `2018-05-29` &lt;dbl&gt; 0.001866262, -0.005991783, -0.004100695, -0.010898882, -0…
#&gt; $ `2018-05-30` &lt;dbl&gt; 0.011632025, 0.009269176, 0.006563649, 0.024874911, 0.035…
#&gt; $ `2018-05-31` &lt;dbl&gt; -0.006743485, 0.001613073, -0.011558758, -0.012972847, -0…
#&gt; $ `2018-06-01` &lt;dbl&gt; -0.004259355, 0.018271889, 0.026244986, 0.012788744, 0.12…
#&gt; $ `2018-06-04` &lt;dbl&gt; 0.003039923, 0.010106794, 0.006612391, 0.038638682, -0.41…
#&gt; $ `2018-06-05` &lt;dbl&gt; -0.005487803, 0.007749225, 0.006244654, 0.009135816, 0.06…
#&gt; $ `2018-06-06` &lt;dbl&gt; -0.006669954, 0.008495343, 0.004123414, 0.025319769, 0.07…
#&gt; $ `2018-06-07` &lt;dbl&gt; 0.0024076022, -0.0106580474, -0.0154097894, -0.0021533389…
#&gt; $ `2018-06-08` &lt;dbl&gt; 0.005674510, 0.006514922, -0.004234921, 0.034115404, 0.02…
#&gt; $ `2018-06-11` &lt;dbl&gt; 0.0017813523, 0.0028726585, -0.0006760786, 0.0018422968, …
#&gt; $ `2018-06-12` &lt;dbl&gt; 0.0078663897, 0.0110997219, 0.0036737737, 0.0064785980, 0…
#&gt; $ `2018-06-13` &lt;dbl&gt; -0.010697336, 0.003580409, -0.001830151, -0.011782038, -0…
#&gt; $ `2018-06-14` &lt;dbl&gt; 0.009497267, 0.009877716, 0.006324038, 0.006708171, 0.054…
#&gt; $ `2018-06-15` &lt;dbl&gt; 0.0056213491, -0.0004856578, -0.0029063280, -0.0049014024…
#&gt; $ `2018-06-18` &lt;dbl&gt; -0.0036275023, 0.0040264473, -0.0044773682, -0.0021505191…
#&gt; $ `2018-06-19` &lt;dbl&gt; 0.0062859688, -0.0051332019, -0.0099666474, -0.0198213640…
#&gt; $ `2018-06-20` &lt;dbl&gt; 0.0048364716, 0.0062656486, 0.0020494721, 0.0156183786, 0…
#&gt; $ `2018-06-21` &lt;dbl&gt; 0.003889050, -0.009103108, -0.010560899, -0.005137809, -0…
#&gt; $ `2018-06-22` &lt;dbl&gt; 0.008593711, -0.005966173, -0.008826225, -0.002430153, -0…
#&gt; $ `2018-06-25` &lt;dbl&gt; 0.010450117, -0.023638499, -0.031233794, -0.008138573, -0…
#&gt; $ `2018-06-26` &lt;dbl&gt; -9.596169e-05, 2.095142e-03, 8.323386e-03, 2.782949e-03, …
#&gt; $ `2018-06-27` &lt;dbl&gt; -0.0008628252, -0.0184620543, -0.0254202908, -0.005855701…
#&gt; $ `2018-06-28` &lt;dbl&gt; 0.0076258054, 0.0121568901, 0.0063902289, 0.0039705827, 0…
#&gt; $ `2018-06-29` &lt;dbl&gt; 0.0004604634, 0.0055363240, 0.0027819370, -0.0150809026, …
#&gt; $ `2018-07-02` &lt;dbl&gt; -0.0028384437, 0.0090260873, 0.0081395192, -0.0009759573,…
#&gt; $ `2018-07-03` &lt;dbl&gt; 0.0043364846, -0.0068765587, -0.0203665301, 0.0020310113,…
#&gt; $ `2018-07-05` &lt;dbl&gt; 1.220050e-02, 8.779294e-03, 2.746686e-02, 9.359615e-05, -…
#&gt; $ `2018-07-06` &lt;dbl&gt; 0.004830259, 0.012930007, 0.011832152, 0.007841180, 0.002…
#&gt; $ `2018-07-09` &lt;dbl&gt; -0.017065731, 0.005889600, 0.008387584, 0.003569912, -0.0…
#&gt; $ `2018-07-10` &lt;dbl&gt; 0.0065232221, 0.0003288737, 0.0097958257, 0.0099024402, -…
#&gt; $ `2018-07-11` &lt;dbl&gt; 0.0032909542, 0.0009998793, -0.0279551458, -0.0167831314,…
#&gt; $ `2018-07-12` &lt;dbl&gt; 4.437596e-04, 2.011703e-02, 1.161042e-02, -7.701430e-03, …
#&gt; $ `2018-07-13` &lt;dbl&gt; 0.0002054118, -0.0025862256, -0.0025276123, -0.0154185700…
#&gt; $ `2018-07-16` &lt;dbl&gt; -0.004860346, -0.003809416, -0.001223772, -0.003578053, 0…
#&gt; $ `2018-07-17` &lt;dbl&gt; -0.0022157193, 0.0082071132, 0.0138708221, -0.0005944396,…
#&gt; $ `2018-07-18` &lt;dbl&gt; -0.0072119931, 0.0011424191, 0.0069947688, -0.0092225964,…
#&gt; $ `2018-07-19` &lt;dbl&gt; 0.008881048, -0.003997411, -0.007736479, 0.005481916, 0.0…
#&gt; $ `2018-07-20` &lt;dbl&gt; -0.0052530834, -0.0005350883, -0.0101195730, -0.005654833…
#&gt; $ `2018-07-23` &lt;dbl&gt; -0.0047972600, 0.0022041281, -0.0001167951, 0.0049671313,…
#&gt; $ `2018-07-24` &lt;dbl&gt; -0.0001825522, -0.0010640251, -0.0130654312, -0.024480144…
#&gt; $ `2018-07-25` &lt;dbl&gt; 0.0063503582, 0.0206729967, 0.0045143373, 0.0069277697, 0…
#&gt; $ `2018-07-26` &lt;dbl&gt; 0.0085576108, -0.0110711088, 0.0218157356, 0.0121349973, …
#&gt; $ `2018-07-27` &lt;dbl&gt; -0.0050227855, -0.0255486016, -0.0049032036, -0.034481812…
#&gt; $ `2018-07-30` &lt;dbl&gt; -0.002139270, -0.026208078, -0.010685590, -0.012369755, 0…
#&gt; $ `2018-07-31` &lt;dbl&gt; 0.0132005835, 0.0069667651, -0.0112722390, 0.0023765964, …
#&gt; $ `2018-08-01` &lt;dbl&gt; -0.003308160, 0.002674729, -0.003127797, -0.026306644, 0.…
#&gt; $ `2018-08-02` &lt;dbl&gt; 0.0044445298, 0.0198178278, 0.0115219721, 0.0179087830, 0…
#&gt; $ `2018-08-03` &lt;dbl&gt; 0.013821704, -0.002751870, 0.001975080, 0.011616620, -0.0…
#&gt; $ `2018-08-06` &lt;dbl&gt; -0.0003684367, 0.0076050379, 0.0074447617, -0.0065698148,…
#&gt; $ `2018-08-07` &lt;dbl&gt; -0.0041706855, 0.0026778704, 0.0071421347, -0.0032299775,…
#&gt; $ `2018-08-08` &lt;dbl&gt; -0.0049937051, -0.0005352376, -0.0001661858, 0.0053762910…
#&gt; $ `2018-08-09` &lt;dbl&gt; 0.001550308, 0.001269768, -0.014103817, -0.005674625, 0.0…
#&gt; $ `2018-08-10` &lt;dbl&gt; -0.005528865, -0.003177257, -0.025395455, -0.006707002, 0…
#&gt; $ `2018-08-13` &lt;dbl&gt; 0.0007030328, -0.0055141194, 0.0028131474, -0.0011200654,…
#&gt; $ `2018-08-14` &lt;dbl&gt; 0.0035114742, 0.0083696607, -0.0004769122, 0.0120167866, …
#&gt; $ `2018-08-15` &lt;dbl&gt; 0.009115179, -0.013703473, -0.015490289, -0.032090836, -0…
#&gt; $ `2018-08-16` &lt;dbl&gt; 9.525890e-03, 4.898682e-03, -8.505536e-05, 6.257623e-03, …
#&gt; $ `2018-08-17` &lt;dbl&gt; 0.008151087, -0.001023532, -0.005537469, 0.008883416, 0.0…
#&gt; $ `2018-08-20` &lt;dbl&gt; -0.000139338, 0.004068927, -0.002828458, 0.019143854, 0.0…
#&gt; $ `2018-08-21` &lt;dbl&gt; -0.009814922, 0.004326463, 0.020599334, -0.007776288, 0.0…
#&gt; $ `2018-08-22` &lt;dbl&gt; -0.007402695, 0.009467249, 0.003890724, 0.006506317, 0.01…
#&gt; $ `2018-08-23` &lt;dbl&gt; -0.001059751, 0.002584191, 0.001441252, -0.001953959, 0.0…
#&gt; $ `2018-08-24` &lt;dbl&gt; 0.004428538, 0.016945261, 0.013019232, 0.004117846, 0.005…
#&gt; $ `2018-08-27` &lt;dbl&gt; -0.003472165, 0.008272378, 0.016414247, -0.012434286, 0.0…
#&gt; $ `2018-08-28` &lt;dbl&gt; 0.0016310568, 0.0035956675, 0.0011374469, 0.0183920291, 0…
#&gt; $ `2018-08-29` &lt;dbl&gt; 0.0025754385, 0.0101200650, -0.0005390346, 0.0101188898, …
#&gt; $ `2018-08-30` &lt;dbl&gt; -0.002905706, -0.003622939, -0.008999835, -0.015824365, -…
#&gt; $ `2018-08-31` &lt;dbl&gt; 0.0006844376, 0.0003435674, 0.0038988766, -0.0105498117, …
#&gt; $ `2018-09-04` &lt;dbl&gt; -0.0022173629, -0.0007844458, -0.0029681163, 0.0037820465…
#&gt; $ `2018-09-05` &lt;dbl&gt; 0.0112202903, -0.0217327169, -0.0075472620, -0.0062308065…
#&gt; $ `2018-09-06` &lt;dbl&gt; 5.470003e-03, 9.056558e-06, -3.130312e-02, 2.126863e-03, …
#&gt; $ `2018-09-07` &lt;dbl&gt; -0.0089431758, -0.0027201853, -0.0057702805, -0.011555806…
#&gt; $ `2018-09-10` &lt;dbl&gt; 0.0056105172, 0.0061835819, 0.0081857426, 0.0096196319, 0…
#&gt; $ `2018-09-11` &lt;dbl&gt; -0.0018266290, 0.0068626629, -0.0143268831, -0.0048945618…
#&gt; $ `2018-09-12` &lt;dbl&gt; 0.0037241739, 0.0005178550, -0.0069917441, 0.0092948871, …
#&gt; $ `2018-09-13` &lt;dbl&gt; 5.154009e-03, 6.435120e-03, 1.007391e-02, -9.913287e-03, …
#&gt; $ `2018-09-14` &lt;dbl&gt; -0.0062581231, 0.0007874498, 0.0079107561, -0.0210201443,…
#&gt; $ `2018-09-17` &lt;dbl&gt; 0.0043141019, -0.0184087988, -0.0118329751, 0.0116812773,…
#&gt; $ `2018-09-18` &lt;dbl&gt; -0.0064302246, 0.0104018153, 0.0105483931, 0.0011495417, …
#&gt; $ `2018-09-19` &lt;dbl&gt; -0.0135202116, -0.0074481010, 0.0037818506, -0.0024189023…
#&gt; $ `2018-09-20` &lt;dbl&gt; 0.0066249624, 0.0094551175, 0.0162585028, 0.0358724217, 0…
#&gt; $ `2018-09-21` &lt;dbl&gt; 0.0025976737, -0.0042590011, 0.0017929146, 0.0146496228, …
#&gt; $ `2018-09-24` &lt;dbl&gt; -0.014953151, 0.009543802, 0.001598997, -0.005450741, 0.0…
#&gt; $ `2018-09-25` &lt;dbl&gt; -0.0062256270, 0.0069767397, -0.0169085839, -0.0087824800…
#&gt; $ `2018-09-26` &lt;dbl&gt; -0.0090724412, 0.0007972829, -0.0122956693, 0.0118154911,…
#&gt; $ `2018-09-27` &lt;dbl&gt; 0.0010610680, 0.0058980186, 0.0044626423, -0.0028367799, …
#&gt; $ `2018-09-28` &lt;dbl&gt; 0.0123895768, 0.0018697088, 0.0062073725, 0.0006963594, 0…
#&gt; $ `2018-10-01` &lt;dbl&gt; -0.0047862102, -0.0025581089, -0.0009568713, 0.0023327520…
#&gt; $ `2018-10-02` &lt;dbl&gt; 0.0055885404, -0.0098654990, -0.0001486533, -0.0292476393…
#&gt; $ `2018-10-03` &lt;dbl&gt; -0.0109619294, 0.0026162693, 0.0020550405, 0.0012603126, …
#&gt; $ `2018-10-04` &lt;dbl&gt; 0.0006634032, -0.0237332903, -0.0196246452, -0.0465294258…
#&gt; $ `2018-10-05` &lt;dbl&gt; 0.0072073791, -0.0105817261, -0.0306989982, -0.0086338916…
#&gt; $ `2018-10-08` &lt;dbl&gt; 0.0121690714, -0.0181845315, -0.0095555874, 0.0044601527,…
#&gt; $ `2018-10-09` &lt;dbl&gt; 0.001638059, -0.001926481, -0.002451397, -0.002086718, 0.…
#&gt; $ `2018-10-10` &lt;dbl&gt; -0.00987750, -0.04998882, -0.03771096, -0.04497825, -0.06…
#&gt; $ `2018-10-11` &lt;dbl&gt; -0.024656372, -0.011936072, -0.005088388, -0.006234847, -…
#&gt; $ `2018-10-12` &lt;dbl&gt; 0.0007631193, 0.0330033245, 0.0203302006, 0.0165520824, 0…
#&gt; $ `2018-10-15` &lt;dbl&gt; 0.006751048, -0.013943734, -0.008688077, 0.004766422, 0.0…
#&gt; $ `2018-10-16` &lt;dbl&gt; 0.01459227, 0.03596301, 0.03150900, 0.02948928, 0.0283210…
#&gt; $ `2018-10-17` &lt;dbl&gt; -0.001577980, 0.002026783, -0.004604694, -0.011911305, 0.…
#&gt; $ `2018-10-18` &lt;dbl&gt; 0.0009584247, -0.0228972884, -0.0210290818, -0.0305859004…
#&gt; $ `2018-10-19` &lt;dbl&gt; 0.014981626, -0.010509263, -0.017036001, -0.017219189, -0…
#&gt; $ `2018-10-22` &lt;dbl&gt; -0.010094651, 0.007768925, 0.002211026, 0.007156364, -0.1…
#&gt; $ `2018-10-23` &lt;dbl&gt; 0.002107001, -0.004042679, -0.003336939, -0.005566678, -0…
#&gt; $ `2018-10-24` &lt;dbl&gt; 0.01452180, -0.04966573, -0.06322654, -0.02012756, -0.073…
#&gt; $ `2018-10-25` &lt;dbl&gt; -0.002610065, 0.030487257, 0.024203710, 0.016094313, 0.00…
#&gt; $ `2018-10-26` &lt;dbl&gt; -0.0200962276, -0.0206845385, -0.0300080310, -0.031133772…
#&gt; $ `2018-10-29` &lt;dbl&gt; 0.015000865, -0.018701877, -0.017941101, 0.001037755, -0.…
#&gt; $ `2018-10-30` &lt;dbl&gt; 0.01088340, 0.02058214, 0.04094304, 0.14925401, 0.0257040…
#&gt; $ `2018-10-31` &lt;dbl&gt; -0.014080964, 0.026186892, 0.017610410, -0.020619102, 0.0…
#&gt; $ `2018-11-01` &lt;dbl&gt; 0.003468374, 0.015516744, 0.056900931, 0.051989082, 0.051…
#&gt; $ `2018-11-02` &lt;dbl&gt; -0.0094880657, -0.0016911407, -0.0118772152, 0.0121737492…
#&gt; $ `2018-11-05` &lt;dbl&gt; 0.015246319, -0.004102911, -0.011493167, 0.001490086, 0.0…
#&gt; $ `2018-11-06` &lt;dbl&gt; 0.0088840511, 0.0079467894, 0.0128404987, -0.0100087193, …
#&gt; $ `2018-11-07` &lt;dbl&gt; 0.008245843, 0.034280833, 0.011885736, -0.061400220, 0.05…
#&gt; $ `2018-11-08` &lt;dbl&gt; 0.0007131304, -0.0004456839, 0.0022079940, -0.0175014576,…
#&gt; $ `2018-11-09` &lt;dbl&gt; 0.005277538, -0.023581410, -0.025983974, -0.003424412, -0…
#&gt; $ `2018-11-12` &lt;dbl&gt; 0.001203075, -0.034791348, -0.046155000, 0.003733015, 0.0…
#&gt; $ `2018-11-13` &lt;dbl&gt; 0.0006520499, -0.0026068393, 0.0155114271, -0.0103126106,…
#&gt; $ `2018-11-14` &lt;dbl&gt; -0.004366738, -0.011677660, 0.004349192, 0.008997432, 0.0…
#&gt; $ `2018-11-15` &lt;dbl&gt; -0.004742111, 0.021441520, 0.035712408, 0.004939976, 0.01…
#&gt; $ `2018-11-16` &lt;dbl&gt; 0.010247295, -0.002191455, -0.008481270, -0.003027428, 0.…
#&gt; $ `2018-11-19` &lt;dbl&gt; 0.001868082, -0.048042913, -0.040374827, -0.023873696, -0…
#&gt; $ `2018-11-20` &lt;dbl&gt; -0.007277836, -0.009039256, 0.001848264, -0.025369756, 0.…
#&gt; $ `2018-11-21` &lt;dbl&gt; -0.007516984, 0.013389586, 0.003767563, 0.025140280, -0.0…
#&gt; $ `2018-11-23` &lt;dbl&gt; 0.0001799561, -0.0066367574, 0.0047840172, 0.0013054052, …
#&gt; $ `2018-11-26` &lt;dbl&gt; 0.001788412, 0.027816743, 0.020594501, 0.024831329, 0.049…
#&gt; $ `2018-11-27` &lt;dbl&gt; 6.840194e-03, -2.199048e-05, 5.328522e-03, -1.279054e-02,…
#&gt; $ `2018-11-28` &lt;dbl&gt; 0.001843236, 0.036027840, 0.022036156, 0.025601171, 0.017…
#&gt; $ `2018-11-29` &lt;dbl&gt; 0.0003752139, -0.0026803489, -0.0164604055, 0.0097908536,…
#&gt; $ `2018-11-30` &lt;dbl&gt; 0.012165990, 0.003065211, 0.015808994, 0.011923396, 0.028…
#&gt; $ `2018-12-03` &lt;dbl&gt; 0.004123854, 0.018371692, 0.031205305, 0.008186916, 0.003…
#&gt; $ `2018-12-04` &lt;dbl&gt; -0.007550281, -0.036775056, -0.058403640, -0.035915469, -…
#&gt; $ `2018-12-06` &lt;dbl&gt; 0.009721326, 0.009112656, -0.006482200, 0.010435450, 0.00…
#&gt; $ `2018-12-07` &lt;dbl&gt; -0.005988745, -0.033458332, -0.041684348, -0.023800039, -…
#&gt; $ `2018-12-10` &lt;dbl&gt; -0.0009617748, 0.0132629505, 0.0083574678, -0.0301738819,…
#&gt; $ `2018-12-11` &lt;dbl&gt; 0.0048324722, 0.0032151543, 0.0021063862, -0.0096611216, …
#&gt; $ `2018-12-12` &lt;dbl&gt; -0.010626919, 0.012411692, 0.012657391, -0.041004302, 0.0…
#&gt; $ `2018-12-13` &lt;dbl&gt; 0.009032959, -0.006873674, -0.008879929, -0.046881818, 0.…
#&gt; $ `2018-12-14` &lt;dbl&gt; -0.005507151, -0.022183383, -0.016262851, -0.013733872, -…
#&gt; $ `2018-12-17` &lt;dbl&gt; -0.032992685, -0.027871931, -0.012290534, -0.039133195, -…
#&gt; $ `2018-12-18` &lt;dbl&gt; -0.002193694, 0.009282636, 0.012835959, 0.005274900, 0.04…
#&gt; $ `2018-12-19` &lt;dbl&gt; -0.005229215, -0.018306521, -0.045885845, -0.038867541, -…
#&gt; $ `2018-12-20` &lt;dbl&gt; -0.007870168, -0.019944742, -0.007190257, -0.036916627, -…
#&gt; $ `2018-12-21` &lt;dbl&gt; -0.01064996, -0.03119476, -0.01934807, -0.04503113, -0.06…
#&gt; $ `2018-12-24` &lt;dbl&gt; -0.040806112, -0.021143989, -0.028840409, -0.016539024, -…
#&gt; $ `2018-12-26` &lt;dbl&gt; 0.02502816, 0.06017855, 0.06140430, 0.06331100, 0.0772263…
#&gt; $ `2018-12-27` &lt;dbl&gt; 0.005329604, 0.012259531, 0.010018175, 0.000232984, 0.011…
#&gt; $ `2018-12-28` &lt;dbl&gt; 0.0005623420, -0.0037282240, 0.0050325631, -0.0045310636,…
#&gt; $ `2018-12-31` &lt;dbl&gt; 0.002910146, 0.010441646, 0.005904153, 0.008908671, -0.02…
#&gt; $ `2019-01-02` &lt;dbl&gt; -0.018497896, -0.004828806, 0.012276054, 0.015416813, 0.0…
#&gt; $ `2019-01-03` &lt;dbl&gt; 0.003547069, -0.033495787, -0.065748764, -0.031789384, -0…
#&gt; $ `2019-01-04` &lt;dbl&gt; 0.01229536, 0.04521014, 0.05245481, 0.06518064, 0.0753641…
#&gt; $ `2019-01-07` &lt;dbl&gt; 0.003580955, 0.016450325, 0.023988620, 0.047956588, 0.078…
#&gt; $ `2019-01-08` &lt;dbl&gt; 0.014799604, 0.014325043, -0.003032616, 0.015403992, 0.11…
#&gt; $ `2019-01-09` &lt;dbl&gt; -0.004334835, 0.013003167, 0.027989324, 0.002485851, 0.01…
#&gt; $ `2019-01-10` &lt;dbl&gt; 0.0141491021, 0.0076258074, 0.0104304695, -0.0012238388, …
#&gt; $ `2019-01-11` &lt;dbl&gt; 0.0006816923, -0.0051954064, 0.0099894722, 0.0196272284, …
#&gt; $ `2019-01-14` &lt;dbl&gt; -0.0071773537, -0.0105707050, -0.0203188944, 0.0011025999…
#&gt; $ `2019-01-15` &lt;dbl&gt; 0.0116984681, 0.0204351392, 0.0014531085, 0.0090727502, 0…
#&gt; $ `2019-01-16` &lt;dbl&gt; 0.0021994012, 0.0001877583, -0.0051054149, -0.0073864628,…
#&gt; $ `2019-01-17` &lt;dbl&gt; 0.005342727, 0.009068244, 0.009985289, 0.021016129, 0.017…
#&gt; $ `2019-01-18` &lt;dbl&gt; 0.004783275, 0.015573087, 0.029225880, 0.010077461, 0.017…
#&gt; $ `2019-01-22` &lt;dbl&gt; -0.003364825, -0.018317692, -0.033428853, -0.014104143, -…
#&gt; $ `2019-01-23` &lt;dbl&gt; 0.0052068074, -0.0028480076, -0.0035590255, -0.0096270731…
#&gt; $ `2019-01-24` &lt;dbl&gt; -0.0032535913, 0.0073469623, 0.0667208224, 0.0101832630, …
#&gt; $ `2019-01-25` &lt;dbl&gt; -0.0007479294, 0.0149106896, 0.0328283403, 0.0311202194, …
#&gt; $ `2019-01-28` &lt;dbl&gt; 0.0043590174, -0.0102497445, -0.0176097639, -0.0014781764…
#&gt; $ `2019-01-29` &lt;dbl&gt; 4.526027e-03, -1.097891e-02, -1.517659e-02, -1.899586e-02…
#&gt; $ `2019-01-30` &lt;dbl&gt; 0.007255936, 0.022979528, 0.034819644, 0.002374046, 0.013…
#&gt; $ `2019-01-31` &lt;dbl&gt; 0.0151598148, 0.0149374332, 0.0034705603, 0.0064726708, -…
#&gt; $ `2019-02-01` &lt;dbl&gt; -0.004983437, 0.005297170, 0.015408115, -0.001445899, -0.…
#&gt; $ `2019-02-04` &lt;dbl&gt; 0.004990535, 0.007095106, 0.003334685, 0.006728491, 0.006…
#&gt; $ `2019-02-05` &lt;dbl&gt; 0.001300246, 0.009704933, 0.001175114, 0.012662412, 0.029…
#&gt; $ `2019-02-06` &lt;dbl&gt; -0.0030787351, -0.0096589503, 0.0297759785, -0.0148130252…
#&gt; $ `2019-02-07` &lt;dbl&gt; 0.006593269, -0.010908942, -0.024770900, -0.023555826, -0…
#&gt; $ `2019-02-08` &lt;dbl&gt; 4.482482e-03, 9.225782e-03, 1.725660e-03, 1.485982e-01, 2…
#&gt; $ `2019-02-11` &lt;dbl&gt; 1.240073e-03, 1.424712e-03, 6.483675e-05, 1.901985e-02, 3…
#&gt; $ `2019-02-12` &lt;dbl&gt; 0.0003740689, 0.0181697062, 0.0238059988, 0.0713405187, -…
#&gt; $ `2019-02-13` &lt;dbl&gt; 0.0014035640, 0.0013495019, 0.0054328795, 0.0095428677, -…
#&gt; $ `2019-02-14` &lt;dbl&gt; -0.0023436883, 0.0035651246, 0.0029953028, -0.0050412271,…
#&gt; $ `2019-02-15` &lt;dbl&gt; 0.006224358, 0.008234295, 0.005261841, -0.063611363, -0.0…
#&gt; $ size         &lt;int&gt; 77, 51, 18, 4, 1, 29, 106, 46, 142, 28
#&gt; $ withinss     &lt;dbl&gt; 2.1841672, 3.5075954, 1.5733337, 0.5638137, 0.0000000, 1.…
#&gt; $ cluster      &lt;fct&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</code></pre>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-21_e94df592fb7078d133fe68ae30182cb2">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(kmeans_obj_challenge_10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["totss"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["tot.withinss"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["betweenss"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["iter"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"33.60445","2":"25.99449","3":"7.609964","4":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-22_25b086380fc0aabf2df7c411a7321dac">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># Add the clusters to the data</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>broom<span class="sc">::</span><span class="fu">augment</span>(kmeans_obj_challenge_10, stock_date_matrix_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>    <span class="fu">select</span>(symbol, .cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".cluster"],"name":[2],"type":["fct"],"align":["left"]}],"data":[{"1":"A","2":"2"},{"1":"AAL","2":"7"},{"1":"AAP","2":"10"},{"1":"AAPL","2":"2"},{"1":"ABBV","2":"9"},{"1":"ABC","2":"9"},{"1":"ABMD","2":"2"},{"1":"ABT","2":"9"},{"1":"ACN","2":"9"},{"1":"ADBE","2":"2"},{"1":"ADI","2":"3"},{"1":"ADM","2":"9"},{"1":"ADP","2":"9"},{"1":"ADS","2":"7"},{"1":"ADSK","2":"2"},{"1":"AEE","2":"1"},{"1":"AEP","2":"1"},{"1":"AES","2":"1"},{"1":"AFL","2":"9"},{"1":"AGN","2":"9"},{"1":"AIG","2":"8"},{"1":"AIV","2":"1"},{"1":"AIZ","2":"9"},{"1":"AJG","2":"9"},{"1":"AKAM","2":"2"},{"1":"ALB","2":"7"},{"1":"ALGN","2":"2"},{"1":"ALK","2":"7"},{"1":"ALL","2":"9"},{"1":"ALLE","2":"7"},{"1":"ALXN","2":"2"},{"1":"AMAT","2":"3"},{"1":"AMD","2":"3"},{"1":"AME","2":"7"},{"1":"AMG","2":"8"},{"1":"AMGN","2":"9"},{"1":"AMP","2":"8"},{"1":"AMT","2":"1"},{"1":"AMZN","2":"2"},{"1":"ANET","2":"2"},{"1":"ANSS","2":"2"},{"1":"ANTM","2":"9"},{"1":"AON","2":"9"},{"1":"AOS","2":"7"},{"1":"APA","2":"6"},{"1":"APC","2":"6"},{"1":"APD","2":"7"},{"1":"APH","2":"9"},{"1":"APTV","2":"7"},{"1":"ARE","2":"1"},{"1":"ARNC","2":"7"},{"1":"ATO","2":"1"},{"1":"ATVI","2":"2"},{"1":"AVB","2":"1"},{"1":"AVGO","2":"3"},{"1":"AVY","2":"7"},{"1":"AWK","2":"1"},{"1":"AXP","2":"8"},{"1":"AZO","2":"10"},{"1":"BA","2":"7"},{"1":"BAC","2":"8"},{"1":"BAX","2":"9"},{"1":"BBT","2":"8"},{"1":"BBY","2":"10"},{"1":"BDX","2":"9"},{"1":"BEN","2":"8"},{"1":"BHF","2":"8"},{"1":"BHGE","2":"6"},{"1":"BIIB","2":"9"},{"1":"BK","2":"8"},{"1":"BKNG","2":"2"},{"1":"BLK","2":"8"},{"1":"BLL","2":"9"},{"1":"BMY","2":"9"},{"1":"BR","2":"9"},{"1":"BSX","2":"9"},{"1":"BWA","2":"7"},{"1":"BXP","2":"1"},{"1":"C","2":"8"},{"1":"CAG","2":"1"},{"1":"CAH","2":"9"},{"1":"CAT","2":"7"},{"1":"CB","2":"9"},{"1":"CBOE","2":"9"},{"1":"CBRE","2":"7"},{"1":"CBS","2":"9"},{"1":"CCI","2":"1"},{"1":"CDNS","2":"2"},{"1":"CE","2":"7"},{"1":"CELG","2":"9"},{"1":"CERN","2":"9"},{"1":"CF","2":"2"},{"1":"CFG","2":"8"},{"1":"CHD","2":"1"},{"1":"CHRW","2":"7"},{"1":"CHTR","2":"9"},{"1":"CI","2":"9"},{"1":"CINF","2":"9"},{"1":"CL","2":"1"},{"1":"CLX","2":"1"},{"1":"CMA","2":"8"},{"1":"CMCSA","2":"9"},{"1":"CME","2":"9"},{"1":"CMG","2":"10"},{"1":"CMI","2":"7"},{"1":"CMS","2":"1"},{"1":"CNC","2":"9"},{"1":"CNP","2":"1"},{"1":"COF","2":"8"},{"1":"COG","2":"9"},{"1":"COO","2":"9"},{"1":"COP","2":"6"},{"1":"COST","2":"9"},{"1":"COTY","2":"4"},{"1":"CPB","2":"1"},{"1":"CPRI","2":"10"},{"1":"CPRT","2":"2"},{"1":"CRM","2":"2"},{"1":"CSCO","2":"2"},{"1":"CSX","2":"7"},{"1":"CTAS","2":"9"},{"1":"CTL","2":"9"},{"1":"CTSH","2":"9"},{"1":"CTXS","2":"9"},{"1":"CVS","2":"9"},{"1":"CVX","2":"6"},{"1":"CXO","2":"6"},{"1":"D","2":"1"},{"1":"DAL","2":"7"},{"1":"DE","2":"7"},{"1":"DFS","2":"8"},{"1":"DG","2":"10"},{"1":"DGX","2":"9"},{"1":"DHI","2":"7"},{"1":"DHR","2":"9"},{"1":"DIS","2":"9"},{"1":"DISCA","2":"9"},{"1":"DISCK","2":"9"},{"1":"DISH","2":"7"},{"1":"DLR","2":"1"},{"1":"DLTR","2":"10"},{"1":"DOV","2":"7"},{"1":"DRE","2":"1"},{"1":"DRI","2":"9"},{"1":"DTE","2":"1"},{"1":"DUK","2":"1"},{"1":"DVA","2":"9"},{"1":"DVN","2":"6"},{"1":"DWDP","2":"7"},{"1":"DXC","2":"9"},{"1":"EA","2":"2"},{"1":"EBAY","2":"9"},{"1":"ECL","2":"9"},{"1":"ED","2":"1"},{"1":"EFX","2":"9"},{"1":"EIX","2":"1"},{"1":"EL","2":"9"},{"1":"EMN","2":"7"},{"1":"EMR","2":"7"},{"1":"EOG","2":"6"},{"1":"EQIX","2":"1"},{"1":"EQR","2":"1"},{"1":"ES","2":"1"},{"1":"ESS","2":"1"},{"1":"ETFC","2":"8"},{"1":"ETN","2":"7"},{"1":"ETR","2":"1"},{"1":"EVRG","2":"1"},{"1":"EW","2":"2"},{"1":"EXC","2":"1"},{"1":"EXPD","2":"7"},{"1":"EXPE","2":"9"},{"1":"EXR","2":"1"},{"1":"F","2":"7"},{"1":"FANG","2":"6"},{"1":"FAST","2":"7"},{"1":"FB","2":"2"},{"1":"FBHS","2":"7"},{"1":"FCX","2":"6"},{"1":"FDX","2":"7"},{"1":"FE","2":"1"},{"1":"FFIV","2":"2"},{"1":"FIS","2":"9"},{"1":"FISV","2":"9"},{"1":"FITB","2":"8"},{"1":"FL","2":"10"},{"1":"FLIR","2":"9"},{"1":"FLR","2":"7"},{"1":"FLS","2":"7"},{"1":"FLT","2":"2"},{"1":"FMC","2":"7"},{"1":"FOX","2":"9"},{"1":"FOXA","2":"9"},{"1":"FRC","2":"8"},{"1":"FRT","2":"1"},{"1":"FTI","2":"6"},{"1":"FTNT","2":"2"},{"1":"FTV","2":"7"},{"1":"GD","2":"7"},{"1":"GE","2":"9"},{"1":"GILD","2":"9"},{"1":"GIS","2":"1"},{"1":"GLW","2":"7"},{"1":"GM","2":"7"},{"1":"GOOG","2":"2"},{"1":"GOOGL","2":"2"},{"1":"GPC","2":"9"},{"1":"GPN","2":"2"},{"1":"GPS","2":"10"},{"1":"GRMN","2":"9"},{"1":"GS","2":"8"},{"1":"GT","2":"7"},{"1":"GWW","2":"7"},{"1":"HAL","2":"6"},{"1":"HAS","2":"9"},{"1":"HBAN","2":"8"},{"1":"HBI","2":"10"},{"1":"HCA","2":"9"},{"1":"HCP","2":"1"},{"1":"HD","2":"9"},{"1":"HES","2":"6"},{"1":"HFC","2":"6"},{"1":"HIG","2":"9"},{"1":"HII","2":"7"},{"1":"HLT","2":"7"},{"1":"HOG","2":"7"},{"1":"HOLX","2":"9"},{"1":"HON","2":"7"},{"1":"HP","2":"6"},{"1":"HPE","2":"9"},{"1":"HPQ","2":"7"},{"1":"HRB","2":"9"},{"1":"HRL","2":"1"},{"1":"HRS","2":"7"},{"1":"HSIC","2":"9"},{"1":"HST","2":"9"},{"1":"HSY","2":"1"},{"1":"HUM","2":"9"},{"1":"IBM","2":"9"},{"1":"ICE","2":"9"},{"1":"IDXX","2":"2"},{"1":"IFF","2":"9"},{"1":"ILMN","2":"2"},{"1":"INCY","2":"2"},{"1":"INFO","2":"9"},{"1":"INTC","2":"3"},{"1":"INTU","2":"2"},{"1":"IP","2":"7"},{"1":"IPG","2":"9"},{"1":"IPGP","2":"3"},{"1":"IQV","2":"2"},{"1":"IR","2":"7"},{"1":"IRM","2":"1"},{"1":"ISRG","2":"2"},{"1":"IT","2":"9"},{"1":"ITW","2":"7"},{"1":"IVZ","2":"8"},{"1":"JBHT","2":"7"},{"1":"JCI","2":"7"},{"1":"JEC","2":"7"},{"1":"JEF","2":"8"},{"1":"JKHY","2":"9"},{"1":"JNJ","2":"9"},{"1":"JNPR","2":"9"},{"1":"JPM","2":"8"},{"1":"JWN","2":"10"},{"1":"K","2":"1"},{"1":"KEY","2":"8"},{"1":"KEYS","2":"2"},{"1":"KHC","2":"1"},{"1":"KIM","2":"1"},{"1":"KLAC","2":"3"},{"1":"KMB","2":"1"},{"1":"KMI","2":"6"},{"1":"KMX","2":"9"},{"1":"KO","2":"1"},{"1":"KR","2":"10"},{"1":"KSS","2":"10"},{"1":"KSU","2":"7"},{"1":"L","2":"9"},{"1":"LB","2":"10"},{"1":"LEG","2":"7"},{"1":"LEN","2":"7"},{"1":"LH","2":"9"},{"1":"LIN","2":"9"},{"1":"LKQ","2":"7"},{"1":"LLL","2":"7"},{"1":"LLY","2":"9"},{"1":"LMT","2":"7"},{"1":"LNC","2":"8"},{"1":"LNT","2":"1"},{"1":"LOW","2":"10"},{"1":"LRCX","2":"3"},{"1":"LUV","2":"7"},{"1":"LW","2":"9"},{"1":"LYB","2":"7"},{"1":"M","2":"10"},{"1":"MA","2":"2"},{"1":"MAA","2":"1"},{"1":"MAC","2":"1"},{"1":"MAR","2":"7"},{"1":"MAS","2":"7"},{"1":"MAT","2":"4"},{"1":"MCD","2":"9"},{"1":"MCHP","2":"3"},{"1":"MCK","2":"9"},{"1":"MCO","2":"9"},{"1":"MDLZ","2":"1"},{"1":"MDT","2":"9"},{"1":"MET","2":"8"},{"1":"MGM","2":"7"},{"1":"MHK","2":"7"},{"1":"MKC","2":"1"},{"1":"MLM","2":"7"},{"1":"MMC","2":"9"},{"1":"MMM","2":"7"},{"1":"MNST","2":"9"},{"1":"MO","2":"1"},{"1":"MOS","2":"7"},{"1":"MPC","2":"6"},{"1":"MRK","2":"9"},{"1":"MRO","2":"6"},{"1":"MS","2":"8"},{"1":"MSCI","2":"2"},{"1":"MSFT","2":"2"},{"1":"MSI","2":"9"},{"1":"MTB","2":"8"},{"1":"MTD","2":"9"},{"1":"MU","2":"3"},{"1":"MXIM","2":"3"},{"1":"MYL","2":"7"},{"1":"NBL","2":"6"},{"1":"NCLH","2":"7"},{"1":"NDAQ","2":"9"},{"1":"NEE","2":"1"},{"1":"NEM","2":"9"},{"1":"NFLX","2":"2"},{"1":"NI","2":"1"},{"1":"NKE","2":"9"},{"1":"NKTR","2":"5"},{"1":"NLSN","2":"9"},{"1":"NOC","2":"7"},{"1":"NOV","2":"6"},{"1":"NRG","2":"9"},{"1":"NSC","2":"7"},{"1":"NTAP","2":"2"},{"1":"NTRS","2":"8"},{"1":"NUE","2":"7"},{"1":"NVDA","2":"3"},{"1":"NWL","2":"7"},{"1":"NWS","2":"9"},{"1":"NWSA","2":"9"},{"1":"O","2":"1"},{"1":"OKE","2":"6"},{"1":"OMC","2":"9"},{"1":"ORCL","2":"9"},{"1":"ORLY","2":"10"},{"1":"OXY","2":"6"},{"1":"PAYX","2":"9"},{"1":"PBCT","2":"8"},{"1":"PCAR","2":"7"},{"1":"PEG","2":"1"},{"1":"PEP","2":"1"},{"1":"PFE","2":"9"},{"1":"PFG","2":"8"},{"1":"PG","2":"1"},{"1":"PGR","2":"9"},{"1":"PH","2":"7"},{"1":"PHM","2":"7"},{"1":"PKG","2":"7"},{"1":"PKI","2":"2"},{"1":"PLD","2":"1"},{"1":"PM","2":"1"},{"1":"PNC","2":"8"},{"1":"PNR","2":"7"},{"1":"PNW","2":"1"},{"1":"PPG","2":"7"},{"1":"PPL","2":"1"},{"1":"PRGO","2":"7"},{"1":"PRU","2":"8"},{"1":"PSA","2":"1"},{"1":"PSX","2":"6"},{"1":"PVH","2":"10"},{"1":"PWR","2":"7"},{"1":"PXD","2":"6"},{"1":"PYPL","2":"2"},{"1":"QCOM","2":"7"},{"1":"QRVO","2":"3"},{"1":"RCL","2":"7"},{"1":"RE","2":"9"},{"1":"REG","2":"1"},{"1":"REGN","2":"9"},{"1":"RF","2":"8"},{"1":"RHI","2":"2"},{"1":"RHT","2":"10"},{"1":"RJF","2":"8"},{"1":"RL","2":"10"},{"1":"RMD","2":"9"},{"1":"ROK","2":"7"},{"1":"ROL","2":"9"},{"1":"ROP","2":"7"},{"1":"ROST","2":"10"},{"1":"RSG","2":"9"},{"1":"RTN","2":"7"},{"1":"SBAC","2":"1"},{"1":"SBUX","2":"9"},{"1":"SCHW","2":"8"},{"1":"SEE","2":"7"},{"1":"SHW","2":"7"},{"1":"SIVB","2":"8"},{"1":"SJM","2":"1"},{"1":"SLB","2":"6"},{"1":"SLG","2":"1"},{"1":"SNA","2":"7"},{"1":"SNPS","2":"2"},{"1":"SO","2":"1"},{"1":"SPG","2":"1"},{"1":"SPGI","2":"9"},{"1":"SRE","2":"1"},{"1":"STI","2":"8"},{"1":"STT","2":"8"},{"1":"STX","2":"3"},{"1":"STZ","2":"9"},{"1":"SWK","2":"7"},{"1":"SWKS","2":"3"},{"1":"SYF","2":"8"},{"1":"SYK","2":"9"},{"1":"SYMC","2":"2"},{"1":"SYY","2":"9"},{"1":"T","2":"9"},{"1":"TAP","2":"9"},{"1":"TDG","2":"7"},{"1":"TEL","2":"7"},{"1":"TFX","2":"9"},{"1":"TGT","2":"10"},{"1":"TIF","2":"10"},{"1":"TJX","2":"10"},{"1":"TMK","2":"8"},{"1":"TMO","2":"9"},{"1":"TPR","2":"10"},{"1":"TRIP","2":"2"},{"1":"TROW","2":"8"},{"1":"TRV","2":"9"},{"1":"TSCO","2":"10"},{"1":"TSN","2":"1"},{"1":"TSS","2":"2"},{"1":"TTWO","2":"2"},{"1":"TWTR","2":"2"},{"1":"TXN","2":"3"},{"1":"TXT","2":"7"},{"1":"UA","2":"4"},{"1":"UAA","2":"4"},{"1":"UAL","2":"7"},{"1":"UDR","2":"1"},{"1":"UHS","2":"9"},{"1":"ULTA","2":"10"},{"1":"UNH","2":"9"},{"1":"UNM","2":"8"},{"1":"UNP","2":"7"},{"1":"UPS","2":"7"},{"1":"URI","2":"7"},{"1":"USB","2":"8"},{"1":"UTX","2":"7"},{"1":"V","2":"2"},{"1":"VAR","2":"9"},{"1":"VFC","2":"10"},{"1":"VIAB","2":"9"},{"1":"VLO","2":"6"},{"1":"VMC","2":"7"},{"1":"VNO","2":"1"},{"1":"VRSK","2":"9"},{"1":"VRSN","2":"2"},{"1":"VRTX","2":"2"},{"1":"VTR","2":"1"},{"1":"VZ","2":"1"},{"1":"WAT","2":"9"},{"1":"WBA","2":"9"},{"1":"WCG","2":"9"},{"1":"WDC","2":"3"},{"1":"WEC","2":"1"},{"1":"WELL","2":"1"},{"1":"WFC","2":"8"},{"1":"WHR","2":"7"},{"1":"WLTW","2":"9"},{"1":"WM","2":"9"},{"1":"WMB","2":"6"},{"1":"WMT","2":"9"},{"1":"WRK","2":"7"},{"1":"WU","2":"9"},{"1":"WY","2":"9"},{"1":"WYNN","2":"7"},{"1":"XEC","2":"6"},{"1":"XEL","2":"1"},{"1":"XLNX","2":"3"},{"1":"XOM","2":"6"},{"1":"XRAY","2":"9"},{"1":"XRX","2":"7"},{"1":"XYL","2":"7"},{"1":"YUM","2":"9"},{"1":"ZBH","2":"9"},{"1":"ZION","2":"8"},{"1":"ZTS","2":"9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-23_e71ad1de1e570987b6c89cbc66e09ec2">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>kmeans_mapper_10 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">centers =</span> <span class="dv">10</span>) {</span>
<span id="cb51-2"><a href="#cb51-2"></a>    </span>
<span id="cb51-3"><a href="#cb51-3"></a>    stock_date_matrix_tbl <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>        <span class="fu">select</span>(<span class="sc">-</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>        <span class="fu">kmeans</span>(<span class="at">centers =</span> centers, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb51-6"><a href="#cb51-6"></a>}</span>
<span id="cb51-7"><a href="#cb51-7"></a></span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="dv">10</span> <span class="sc">%&gt;%</span> <span class="fu">kmeans_mapper_10</span>() <span class="sc">%&gt;%</span> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["totss"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["tot.withinss"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["betweenss"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["iter"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"33.60445","2":"25.99755","3":"7.6069","4":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-24_a43cc85b8168bf57f1e433b9d86bf50d">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># Mapping the function to many elements</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>kmeans_mapped_tbl_challenge_10 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">centers =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>    <span class="fu">mutate</span>(<span class="at">k_means =</span> centers <span class="sc">%&gt;%</span> <span class="fu">map</span>(kmeans_mapper_10)) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>    <span class="fu">mutate</span>(<span class="at">glance  =</span> k_means <span class="sc">%&gt;%</span> <span class="fu">map</span>(glance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-25_c5c34fb2f5e5def2621967168dd37570">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>kmeans_mapped_tbl_challenge_10 <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>    <span class="fu">unnest</span>(glance) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>    <span class="fu">select</span>(centers, tot.withinss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["centers"],"name":[1],"type":["int"],"align":["right"]},{"label":["tot.withinss"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"33.60445"},{"1":"2","2":"31.40409"},{"1":"3","2":"30.17267"},{"1":"4","2":"29.20555"},{"1":"5","2":"28.56583"},{"1":"6","2":"27.95312"},{"1":"7","2":"27.41673"},{"1":"8","2":"26.89418"},{"1":"9","2":"26.40817"},{"1":"10","2":"25.99746"},{"1":"11","2":"25.62996"},{"1":"12","2":"25.30832"},{"1":"13","2":"25.06232"},{"1":"14","2":"24.67362"},{"1":"15","2":"24.41278"},{"1":"16","2":"24.16378"},{"1":"17","2":"23.94631"},{"1":"18","2":"23.71081"},{"1":"19","2":"23.49920"},{"1":"20","2":"23.20678"},{"1":"21","2":"22.96609"},{"1":"22","2":"22.74770"},{"1":"23","2":"22.53224"},{"1":"24","2":"22.28176"},{"1":"25","2":"22.08398"},{"1":"26","2":"21.86891"},{"1":"27","2":"21.73920"},{"1":"28","2":"21.45334"},{"1":"29","2":"21.29574"},{"1":"30","2":"21.05113"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-26_459ae1b5aa5f6897ea037b297f216540">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>umap_obj_challenge_10 <span class="ot">&lt;-</span> stock_date_matrix_tbl <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>    <span class="fu">select</span>(<span class="sc">-</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>    <span class="fu">umap</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-27_3a081ab50cc5ca4e89f7a9755603ec97">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>umap_results_tbl_challenge_10 <span class="ot">&lt;-</span> umap_obj_challenge_10<span class="sc">$</span>layout <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>    <span class="fu">as_tibble</span>(<span class="at">.name_repair =</span> <span class="st">"unique"</span>) <span class="sc">%&gt;%</span> <span class="co"># argument is required to set names in the next step</span></span>
<span id="cb55-3"><a href="#cb55-3"></a>    <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb55-5"><a href="#cb55-5"></a>        stock_date_matrix_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(symbol)</span>
<span id="cb55-6"><a href="#cb55-6"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>umap_results_tbl_challenge_10 <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>    <span class="fu">theme_tq</span>() <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb57-5"><a href="#cb57-5"></a>    <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> symbol), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6"></a>    <span class="fu">labs</span>(</span>
<span id="cb57-7"><a href="#cb57-7"></a>        <span class="at">title =</span> <span class="st">"UMAP Projection for 10 centers"</span>,</span>
<span id="cb57-8"><a href="#cb57-8"></a>        <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb57-9"><a href="#cb57-9"></a>        <span class="at">fill =</span> <span class="st">""</span></span>
<span id="cb57-10"><a href="#cb57-10"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_fundamental_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="01_fundamental_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-28_e74e3313f222fe717ac5882699de62e6">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>umap_results_tbl_challenge_10 <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>    <span class="fu">theme_tq</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5"></a>    <span class="co">#geom_label_repel(aes(label = symbol), size = 2) +</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>    <span class="fu">labs</span>(</span>
<span id="cb58-7"><a href="#cb58-7"></a>        <span class="at">title =</span> <span class="st">"UMAP Projection for 10 centers"</span>,</span>
<span id="cb58-8"><a href="#cb58-8"></a>        <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb58-9"><a href="#cb58-9"></a>        <span class="at">fill =</span> <span class="st">""</span></span>
<span id="cb58-10"><a href="#cb58-10"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_fundamental_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="01_fundamental_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-29_5f5737e7d6cb38a97e8007a21034e271">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>kmeans_10_obj <span class="ot">&lt;-</span> kmeans_mapped_tbl_challenge_10 <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>    <span class="fu">pull</span>(k_means) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>    <span class="fu">pluck</span>(<span class="dv">10</span>)</span>
<span id="cb59-4"><a href="#cb59-4"></a></span>
<span id="cb59-5"><a href="#cb59-5"></a><span class="co"># Convert it to a tibble with broom</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>kmeans_10_clusters_tbl_challenge <span class="ot">&lt;-</span> kmeans_10_obj <span class="sc">%&gt;%</span> </span>
<span id="cb59-7"><a href="#cb59-7"></a>    <span class="fu">augment</span>(stock_date_matrix_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="#cb59-8"></a>    <span class="co"># Select the data we need</span></span>
<span id="cb59-9"><a href="#cb59-9"></a>    <span class="fu">select</span>(symbol, .cluster)</span>
<span id="cb59-10"><a href="#cb59-10"></a></span>
<span id="cb59-11"><a href="#cb59-11"></a><span class="co"># Bind data together</span></span>
<span id="cb59-12"><a href="#cb59-12"></a>umap_kmeans_10_results_tbl_challenge <span class="ot">&lt;-</span> umap_results_tbl_challenge_10 <span class="sc">%&gt;%</span></span>
<span id="cb59-13"><a href="#cb59-13"></a>    <span class="fu">left_join</span>(kmeans_10_clusters_tbl_challenge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Joining with `by = join_by(symbol)`</code></pre>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-30_5a8202cbe8b036f0387dc194acd8432e">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>umap_kmeans_10_results_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>    <span class="fu">mutate</span>(<span class="at">label_text =</span> <span class="fu">str_glue</span>(<span class="st">"Company: {symbol}</span></span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="st">                                 Cluster: {.cluster}"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4"></a>    </span>
<span id="cb61-5"><a href="#cb61-5"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">color =</span> .cluster)) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6"></a>    </span>
<span id="cb61-7"><a href="#cb61-7"></a>    <span class="co"># Geometries</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>    <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_text), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#282A36"</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>    </span>
<span id="cb61-11"><a href="#cb61-11"></a>    <span class="co"># Formatting</span></span>
<span id="cb61-12"><a href="#cb61-12"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#2d72d6"</span>, <span class="st">"#2dc6d6"</span>, <span class="st">"#2dd692"</span>, <span class="st">"#e5217a"</span>, <span class="st">"#09d3c2"</span>, <span class="st">"#ff8800"</span>, <span class="st">"#5c25a2"</span>, <span class="st">"#42bf39"</span>, <span class="st">"#f0c800"</span>, <span class="st">"#3f8ed6"</span>)) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Customer Segmentation: 2D Projection"</span>,</span>
<span id="cb61-14"><a href="#cb61-14"></a>    <span class="at">subtitle =</span> <span class="st">"UMAP 2D Projection with K-Means Cluster Assignment"</span>,</span>
<span id="cb61-15"><a href="#cb61-15"></a>    <span class="at">caption =</span> <span class="st">"Conclusion: 10 Company Segments identified using 2 algorithms"</span>) <span class="sc">+</span></span>
<span id="cb61-16"><a href="#cb61-16"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_fundamental_files/figure-html/unnamed-chunk-30-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="01_fundamental_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="01_fundamental_cache/html/unnamed-chunk-31_7a0a85aa5611ebd4f334718eebe5da77">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>umap_kmeans_10_results_tbl_challenge <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>    <span class="fu">mutate</span>(<span class="at">label_text =</span> <span class="fu">str_glue</span>(<span class="st">"Company: {symbol}</span></span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="st">                                 Cluster: {.cluster}"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>    </span>
<span id="cb62-5"><a href="#cb62-5"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">color =</span> .cluster)) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>    </span>
<span id="cb62-7"><a href="#cb62-7"></a>    <span class="co"># Geometries</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9"></a>    <span class="co">#geom_label_repel(aes(label = label_text), size = 2, fill = "#282A36") +</span></span>
<span id="cb62-10"><a href="#cb62-10"></a>    </span>
<span id="cb62-11"><a href="#cb62-11"></a>    <span class="co"># Formatting</span></span>
<span id="cb62-12"><a href="#cb62-12"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#2d72d6"</span>, <span class="st">"#2dc6d6"</span>, <span class="st">"#2dd692"</span>, <span class="st">"#e5217a"</span>, <span class="st">"#09d3c2"</span>, <span class="st">"#ff8800"</span>, <span class="st">"#5c25a2"</span>, <span class="st">"#42bf39"</span>, <span class="st">"#f0c800"</span>, <span class="st">"#3f8ed6"</span>)) <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Customer Segmentation: 2D Projection"</span>,</span>
<span id="cb62-14"><a href="#cb62-14"></a>    <span class="at">subtitle =</span> <span class="st">"UMAP 2D Projection with K-Means Cluster Assignment"</span>,</span>
<span id="cb62-15"><a href="#cb62-15"></a>    <span class="at">caption =</span> <span class="st">"Conclusion: 10 Company Segments identified using 2 algorithms"</span>) <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="01_fundamental_files/figure-html/unnamed-chunk-31-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="01_fundamental_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","closeEffect":"zoom","descPosition":"bottom","loop":true,"openEffect":"zoom"});</script>



</body></html>